function RenderSuiteLinksFromShellData(d,a,n,k){var A=window.OffSwitch&&window.OffSwitch.IsActive("fdbaaf48-4f49-439b-b4ea-c3fa86f8c2bb","04/15/2019","Disable SuiteNav Render For SharePointDesktopApp");if(!A&&navigator.userAgent.indexOf("SharePointDesktop")>-1){document.getElementById(d).style.height="0px";return}var L="ShellDocuments",V="ShellSites",W="ShellSharepoint",j=4e3,g=false,h=false,X="javascript:",m="SPSuiteThemeInfo",G=54,D=21,F=16,N=64;if(typeof a!="number"||a<1)a=1;function l(a){if(typeof BrowserStorage!="undefined")return BrowserStorage.local.getItem(a);try{return localStorage[a]}catch(b){return null}}function s(b,a){if(typeof BrowserStorage!="undefined"){BrowserStorage.local.setItem(b,a);return}try{localStorage[b]=a}catch(c){}}function E(a){BrowserStorage.local.removeItem(a)}function o(a){window.console!=null&&console.warn!=null&&console.warn(a)}function U(a){SP.QoS.WriteStart(a,null,SP.QoS.LogType.Diagnostic)}function z(a){SP.QoS.WriteSuccess(a,null,SP.QoS.LogType.Diagnostic)}function u(b){var a=typeof Flighting!=="undefined"&&Flighting.VariantConfiguration!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(b);return a}function y(){return SuiteNavRendering.GetWebTemplate()}function p(d,c){for(var b=0;b<d.length;b++){var a=d[b];if(Boolean(a))if(c!=null&&a.Id==L)a.Url=c}}function K(){try{var a=JSON.parse(l("SPMySiteLinks")),b=Date.parse(a.CacheDate);if(b>0&&(new Date).getTime()-b<24*60*60*1e3&&GetCurrentUserKey()==a.UserKey)return a}catch(c){}return null}function P(d,b){var a=null,c=null;function f(b,c,d){var a={};a.AllDocumentsLink=c;a.AllSitesLink=d;b(JSON.stringify(a))}function h(b){var c=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,d=escapeUrlForCallback(c)+"/_api/Microsoft.SharePoint.Portal.UserProfiles.MySiteLinks.GetMySiteLinks",a=new XMLHttpRequest;a.open("GET",d,true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.setRequestHeader("ACCEPT","application/json; odata=verbose");a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){var c=null;try{c=JSON.parse(a.responseText)}catch(g){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(Boolean(c)&&Boolean(c.d)&&(Boolean(c.d.AllDocumentsLink)||Boolean(c.d.AllSitesLink))){var e=Boolean(c.d.AllDocumentsLinkHref)?c.d.AllDocumentsLinkHref:c.d.AllDocumentsLink,d=Boolean(c.d.AllSitesLinkHref)?c.d.AllSitesLinkHref:c.d.AllSitesLink;f(b,e,d);return}}f(b,null,null)}};a.send()}function i(g){if(!Boolean(g)){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");b(d);return}var e=JSON.parse(g);if(e!=null){var f=e.AllDocumentsLink,h=e.AllSitesLink;try{s("SPMySiteLinks",JSON.stringify({Docs:f,Sites:h,CacheDate:new Date,UserKey:GetCurrentUserKey()}))}catch(j){}p(c,f,h)}var i=JSON.stringify(a);b(i)}try{a=JSON.parse(d)}catch(j){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(a!=null){var g=ExtractSuiteNavBarData(a);c=g!=null?g.WorkloadLinks:a.WorkloadLinks}var e=K();if(c==null)b(d);else if(e!=null){p(c,e.Docs,e.Sites);b(JSON.stringify(a))}else h(i)}function f(d){if(window.XMLHttpRequest==null)return;function e(){if(j<30*60*1e3){var a=setTimeout(function(){f(d)},j);AddEvtHandler(window,"onunload",function(){clearTimeout(a)});j=j*2}}if(h)return;h=true;var i=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,b=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState!=4)return;h=false;if(g)return;if(b.status==200){g=true;var c=false;if(a>=2&&!Boolean(k)){var f=b.getResponseHeader("Content-Type");if(f==null&&f.indexOf("application/json")<0){o("SuiteNav: Invalid Shell data recieved.");c=true}}!c&&P(b.responseText,d)}else e()};b.ontimeout=e;var c="/_layouts/online/handlers/SpoSuiteLinks.ashx";c=escapeUrlForCallback(i)+(typeof ajaxNavigate!=="undefined"?ajaxNavigate._fixLayoutsUrl(c):typeof FixLayoutsUrl!=="undefined"?FixLayoutsUrl(c):c);b.open("POST",c+"?Locale="+escapeUrlForCallback(_spPageContextInfo.currentUICultureName)+"&v="+String(a)+"&mobilereq="+String(k===true?1:0),true);b.send("");return null}function t(a){SuiteNavRendering.UpdateActiveLink(a)}function v(a){if(typeof a!="string"||a=="")return false;return true}function I(a){SuiteNavRendering.AddMenuItemsFromDOM(a)}function T(a){SuiteNavRendering.UpdateHelpLink(a)}function M(a){var b=window.OffSwitch&&window.OffSwitch.IsActive("82F8C6A5-2C13-4635-BC09-7E84C16105E4","03/05/2017","Disable Feedback When it is not supported.");if(u(952)&&(b||typeof window._TenantAdminUserVoice!==typeof undefined)){a.FeedbackLink.TargetWindow="_self";a.FeedbackLink.Url="javascript:_TenantAdminUserVoice.openWidget()"}else a.FeedbackLink=null}function H(){var a=O365Shell.Host.OnContextMenuPopup(function(a){a&&MenuHtc_hide()});O365Shell.OnDataChanged&&O365Shell.OnDataChanged(Q);AddEvtHandler(window,"onunload",function(){O365Shell.Host.RemoveOnContextMenuPopup(a);O365Shell.Host.FlushTaskRunnerQueue()})}function x(){try{var a=l("SPSuiteNavHeight");if(a!=null)document.getElementById(d).style.height=a}catch(b){}}function S(){var b=l(m);if(b!=null){if(SPThemeUtils.UseClientSideTheming()){E(m);return []}for(var c=JSON.parse(b),a=0;a<document.styleSheets.length;a++){var d=document.styleSheets[a];if(c.Url==d.href)return c.Colors}}return []}function R(){var a=y(),b=a==G||a==D||a==N;return b}function O(r){var e=ExtractSuiteNavBarData(r),K=R();if(e==null)return;if(!K)e.UseSPOBehaviors=true;if(RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(r)||K&&Boolean(e.HasTenantBranding)||y()==F)return;if(u(516)){if(Boolean(e.HasTenantBranding)&&(r.TenantPrimaryColorShades!=null||e.TenantLogoUrl!=null))return}else if(Boolean(e.HasTenantBranding)&&typeof SPThemeUtils!=="undefined"&&!SPThemeUtils.IsSiteThemed())return;var a=S();if(a==null||a.length==0)a=[];else{e.ThemeColors=a;return}function N(b,c){if(b>=0)a[b]=c}function g(e,c){var a=c.backgroundColor,d=Boolean(a);if(d){if(a.toLowerCase()=="transparent"&&c.filter!=null){var b=/startColorstr=(#[0-9A-F]*),/ig.exec(c.filter);if(b!=null&&b.length>1)a="#"+b[1].substr(3)}N(e,a)}return d}function h(c,b){var a=Boolean(b.color);a&&N(c,b.color);return a}var p={},q=0;function d(b,c){for(var a=0;a<b.length;a++)p[b[a]]=c;q++}var T=browseris.ie8down,f=T?".ms-core-neediefilter ":"",M=e.Dimensions==null||e.Dimensions.Top<40,W=[2,-1,4,9,5,6,7,1,8,10,3,-1];function c(a){return M?a:W[a]}var i=c(0),C=c(1),x=c(2),z=c(3),o=c(4),H=c(5),A=c(6),I=c(7),J=c(8),E=c(9),G=c(10),B=c(11);function L(){if(!M&&a[i]!=null)a[0]=a[i];e.ThemeColors=a}if(SPThemeUtils.UseClientSideTheming()){var b=SPThemeUtils.GetThemeColor,O=1,k=T?O:void 0,Y=a[i]=b("SuiteBarBackground",k);if(Y==null)return;a[C]=b("SuiteBarHoverBackground",k);var D=b("SuiteBarHoverText"),V="#92c0e0";a[x]=D==null?V:D;a[z]=b("HoverBackground",k);a[o]=b("TopBarBackground",k);a[H]=b("TopBarText");a[A]=b("TopBarHoverText");a[I]=b("BodyText");a[J]=b("BackgroundOverlay",O);a[E]=b("DialogBorder");a[G]=b("SuiteBarText");a[B]=b("SubtleLines");L();return}d(["#suitebarleft"],function(a){f===""&&g(i,a);return h(G,a)});f!==""&&d([f+"#suitebarleft"],function(a){return g(i,a)});d([f+".ms-core-suitelink-a:hover"],function(a){return g(C,a)});d(["a.ms-core-suitelink-disabled, a.ms-core-suitelink-disabled:hover","a.ms-core-suitelink-disabled"],function(a){return !Boolean(a.padding)&&h(x,a)});d([f+".ms-core-menu-item:hover, "+f+".ms-core-menu-itemselected",f+".ms-core-menu-item:hover"],function(a){return g(z,a)});f!==""&&d([f+"#suitebarright"],function(a){return g(o,a)});d(["#suitebarright"],function(a){f===""&&g(o,a);return h(H,a)});d(["a.ms-core-menu-link"],function(a){return h(I,a)});d(["a.ms-core-suitelink-active, a.ms-core-suitelink-active:hover, .ms-core-neediefilter a.ms-core-suitelink-active, .ms-core-neediefilter a.ms-core-suitelink-active:hover","a.ms-core-suitelink-active"],function(b){var c=b.borderRightColor;a[E]=c!=null&&c!=""?c:b.borderLeftColor;h(A,b);return g(J,b)});d([".ms-core-menu-separatorhr"],function(a){return h(B,a)});for(var j=0,P="",t=0;t<document.styleSheets.length&&j<q;t++){j=0;var l=document.styleSheets[t];P=l.href;var v=l.rules!=null?l.rules:l.cssRules;if(!Boolean(v))continue;for(var w=v.length-1;w>0&&j<q;w--){var n=v[w];if(n.style!=null&&n.selectorText!=null){var U=n.selectorText.toLowerCase(),Q=p[U];if(Q!=null&&Q(n.style)){p[U]=null;j++}}}}if(j>0){L();var X={Url:P,Colors:a};s(m,JSON.stringify(X))}}function B(a){var b="display";while(a!=null){if(IE8Support.getComputedStyle(a,b,b)==="none")return true;if(a.nodeName.toLowerCase()==="body")break;a=a.parentNode}return false}function q(b){var a=null;try{if(b!=null)a=ExtractSuiteMetadata(b)}catch(c){}return a}var c=false,e=false,b=false,i=null;function w(c){if(b&&g)i=function(){w(c)};if(d==null||e||b)return;var a=q(c);if(Boolean(RenderSuiteLinksFromShellData.ShellJson)&&Boolean(RenderSuiteLinksFromShellData.ShellJsUrl)&&RenderSuiteLinksFromShellData.ShellJsUrl!==a.JsUrl)a=q(RenderSuiteLinksFromShellData.ShellJson);if(a==null||!v(a.CssUrl)||!v(a.JsUrl))o("SuiteNav: Valid JsUrl and CssUrl not found.");else C(a)}function C(f){if(e||b)return;try{var A=JSON.stringify(f),a=ExtractSuiteNavBarData(f);if(a==null)return;t(a);var C=f.CssUrl,s=f.JsUrl;registerCssLink(C,null,true);var w=10,v=50,q=0;function n(){b=false;if(e||typeof O365Shell!="undefined")return;if(typeof O365Shell=="undefined"&&q<w){q++;b=true;setTimeout(k,v);return}if(!c&&!g){c=true;if(!h){ClearSuiteLinksCache();r()}}else if(!c&&i!=null){c=true;i();i=null}else{c=true;o("SuiteNav: Unable to load Shell scripts.")}}function p(){try{x();I(a);T(a);M(a);O(f)}catch(b){}}function k(){b=false;if(e)return;if(typeof O365Shell=="undefined"){n();return}else c=false;RenderSuiteLinksFromShellData.ShellJson=A;if(!Boolean(RenderSuiteLinksFromShellData.ShellJsUrl))RenderSuiteLinksFromShellData.ShellJsUrl=s;function f(){p();var b=document.getElementById(d);b!=null&&typeof RemoveCssClassFromElement!="undefined"&&RemoveCssClassFromElement(b,"ms-TopBarBackground-bgColor");O365Shell.SetData(a);var c={top:d,disableDelayLoad:true,disableShellPlus:true,layout:"Mouse"};if(!B(b)){var e=window.OffSwitch&&window.OffSwitch.IsActive("5BE31C31-56EB-4EDD-801A-EC36F75169DF","11/28/2018","Render Suite Nav with RenderAsync if defined");if(e||O365Shell.RenderAsync!=null){O365Shell.RenderAsync(c,u,m);j()}else{O365Shell.Render(c,m);j();setTimeout(function(){O365Shell.LoadShellPlus!=null&&O365Shell.LoadShellPlus()},2e3)}}else z("SuiteNav_SuccessRender")}SPThemeUtils.WhenThemeReady(f);e=true}function u(){setTimeout(function(){O365Shell.LoadShellPlus!=null&&O365Shell.LoadShellPlus()},2e3)}function m(){H();SP.SOD.notifyEventAndExecuteWaitingJobs("SPShellPlusLoaded",[a])}function j(){z("SuiteNav_SuccessRender");SP.SOD.notifyEventAndExecuteWaitingJobs("SPSuiteLinksRendered",[a]);RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(f)&&SPThemeUtils.GetCurrentThemeCacheToken()!=f.ShellRequestId&&setTimeout(SPThemeUtils.ApplyCurrentTheme,0)}var y=navigator.userAgent.indexOf("SharePointDesktop")>-1||typeof GetUrlKeyValue=="function"&&Boolean(GetUrlKeyValue("unsuitened"));if(y){p();j()}else if(typeof O365Shell=="undefined"){if(typeof RenderSuiteLinksFromShellData.JsVer=="undefined")RenderSuiteLinksFromShellData.JsVer=0;var l="o365shell_js"+RenderSuiteLinksFromShellData.JsVer++;if(f.JsKey==null)SP.SOD.registerSod(l,s);else l=f.JsKey;b=true;SP.SOD.executeFunc(l,"O365Shell",k,n)}else k();SP.SOD.execute("core.js","UpdateCompanyDisplayName",a)}catch(D){}}function J(){g=false;h=false}function Q(){J();GetSuiteLinks(f,null,a,false,true)}function r(){GetSuiteLinks(f,Boolean(n)?n:w,a,k)}if(a<2)if(typeof EnsureScriptParams!=="undefined")EnsureScriptParams("suitelinks.js","RenderSuiteLinks",d,f,t);else typeof GetSuiteLinks!=="undefined"&&GetSuiteLinks(f,n);else{!k&&U("SuiteNav_StartRender");x();r()}}function RetrieveAndProcessSuiteNavData(a,b){RenderSuiteLinksFromShellData(null,b,a,true)}(function(){RenderSuiteLinksFromShellData.ShouldUseSuiteTheme=e;var d=54,c=21;function f(){return SuiteNavRendering.GetWebTemplate()}function e(b){return typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.UseShellThemes()&&!SPThemeUtils.IsSiteThemed()&&a(b)!=null}function b(h,b){if(b==null||b.length<7)return;for(var f=[["HyperlinkActive","CommandLinksPressed","NavigationPressed","EmphasisHoverBorder","TopBarPressedText","HeaderNavigationPressedText","Hyperlinkfollowed"],["EmphasisHoverBackground","EmphasisBorder"],["AccentText","CommandLinksHover","RowAccent","NavigationAccent","NavigationHover","EmphasisBackground","HeaderNavigationHoverText","HeaderNavigationSelectedText","SuiteBarBackground","Hyperlink","ContentAccent1"],["AccentLines","HeaderAccentLines","ButtonPressedBorder"],["SuiteBarHoverBackground"],["StrongLines","HeaderStrongLines","SuiteBarHoverText","ButtonPressedBackground","ButtonHoverBorder"],["ButtonHoverBackground"],["SelectionBackground"],["HoverBackground","NavigationHoverBackground"]],d,g,c,i=f.length,a=0;a<i;a++){if(a==7)c="#7F"+b[5];else if(a==8)c="#7F"+b[6];else c="#"+b[a];d=f[a];g=d.length;for(var e=0;e<g;e++)h.SetColor(d[e],c)}}function a(a){var b=null;if(a!=null&&Boolean(a.ThemeVersion)){var h=a.TenantPrimaryColorShades!=null,i=a.UserThemePrimaryColorShades!=null,g=Boolean(a.UserPersonalizationAllowed),e=f(),j=e==d||e==c;if(j&&(!h||g&&i))b=a.UserThemePrimaryColorShades;else b=a.TenantPrimaryColorShades;if(b==null||b.length<6)b=null}return b}function g(c){if(!SPThemeUtils.UseShellThemes()||SPThemeUtils.IsSiteThemed())SPThemeUtils.WithSiteTheme(c);else GetSuiteLinks(null,d,2);function d(f){var e=f!=null?ExtractSuiteMetadata(f):null,d=null;if(e!=null&&e.ShellRequestId!=null)d=a(e);function g(a){var f=null;if(d!=null&&a!=null){b(a,d);a.CacheToken=e.ShellRequestId;a.IsDefault=false;a.NoImageRecoloring=false}c(a)}d!=null&&SPThemeUtils.LoadThemableResources();SPThemeUtils.WithSiteTheme(g)}}typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.SetThemeRetriever(g)})();typeof NotifyScriptLoadedAndExecuteWaitingJobs!=="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("SpoSuiteNav.js")