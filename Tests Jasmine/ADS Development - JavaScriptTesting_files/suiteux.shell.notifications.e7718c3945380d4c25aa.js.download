var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_notifications_start"),(window.suiteux_shell_webpackJsonp=window.suiteux_shell_webpackJsonp||[]).push([["notifications"],{"0290f4e8302ad778":function(e,t,n){e.exports={toggleBackground:"_1qsvj6mree-X2EqDkQUOMI",toggleOn:"_226Yp9AdxwilGIHUGXF8Sz",toggleOff:"pHF5Pl_v0Yp_LkqV7kIGb"}},"04567c0fa98bd173":function(e,t,n){e.exports={wrapperStyle:"_2ojI5nLfEBAz0v4pNz-vkL"}},"06aaa7d4b6d44083":function(e,t,n){"use strict";n.d(t,"a",function(){return S});var i,a,o=n("57554efb244a2e6c"),r=n("93cebf3bb203b06a"),s=n("4f9561d9673adc83"),c=n("0e6a3e4aca161152"),l=n("0d05d74f4c592f54"),d=n("f10d3ac77c67e555"),u=n("59112cfb0e33e90b"),f=n("7bd3263b26b48094"),p=n("a15570f8ebd19e9e"),m=n("2a336278accbeab0"),h=n("bed867ddee695404"),b=8*l.b,S=function(){function e(){}return e.handleNotification=function(e,t){if(null!==e){e&&e.shouldGetReminders&&this.GetRemindersFromServer()}},e.GetReminderNotificationItem=function(e){var t=null;if(e&&e.length>0){var n=e.filter(function(e){return e.providerType===u.a.ReminderNotification});null!=n&&n.length>0&&(t=n[0])}return t},e.GetRemindersFromServer=function(){a&&window.clearInterval(a),h.CallbackManager.subscribe("SuiteAPILoaded",function(){s.a.Instance.Calendar.getReminders(null,c.a.UTCNow.addDays(10).getNativeDateTime(),!0,c.a.timeZone).then(function(t){e.OnGetRemindersFromServerSucceeded(t)}).catch(function(e){!1===r.h.isCallsBlockedException(e)&&o.a.exception("Notifications_GetRemindersFromServer_Failed",6,e)})},!0)},e.OnGetRemindersFromServerSucceeded=function(t){var n=this,i=Object(d.L)(),o=i.getState().notificationState.notifications.slice(0),r=Object(m.a)(o,!0);if(r.length>0)i.dispatch(Object(p.l)(!0,null,r[0].payload.id));else{if(null!=t){var s,c=[];t.forEach(function(t){n.isVisibleReminderOverdue(t.EndDate)&&(s=e.CreateReminderItem(t,0),c.push(s))}),e.OnGetRemindersSucceeded(c)}a=window.setTimeout(function(){n.GetRemindersFromServer()},b)}},e.CreateReminderItem=function(e,t){var n={Subject:e.Subject,Location:e.Location,ReminderTime:c.a.parseISO8601DateTime(e.ReminderTime),StartDate:c.a.parseISO8601DateTime(e.StartDate),EndDate:c.a.parseISO8601DateTime(e.EndDate),ItemId:e.ItemId,RecurringMasterItemId:e.RecurringMasterItemId,ReminderGroup:e.ReminderGroup||0,ReminderGroups:e.ReminderGroupTypes,JoinOnlineMeetingUrl:e.JoinOnlineMeetingUrl,displayState:t};return new f.a(n)},e.initalReminderNotification=function(e){return{providerType:u.a.ReminderNotification,payload:{id:u.a[u.a.ReminderNotification]+Object(m.d)()+Math.floor(1e3*Math.random()),reminder:e},toastState:0,toastType:1,navigationUrl:null}},e.OnGetRemindersSucceeded=function(t){var n=this,i=Object(d.L)(),a=Object(m.a)(i.getState().notificationState.notifications.slice(0),!1),o=[],r=t.sort(function(e,t){return e.ReminderItemDataModel.StartDate.compare(t.ReminderItemDataModel.StartDate)}).map(function(e){return n.initalReminderNotification(e)}),s=c.a.UTCNow,l=0;if(r.forEach(function(e){e.payload.reminder.ReminderItemDataModel.ReminderTime.toUTC().compare(s)>0?o.push(e.payload.reminder):(a.length>l?i.dispatch(Object(p.l)(!1,e.payload.reminder,a[l].payload.id)):i.dispatch(Object(p.a)(e)),l++)}),a.length>l)for(var u=l;u<a.length;u++)i.dispatch(Object(p.l)(!0,null,a[u].payload.id));i.dispatch(Object(p.k)(o)),e.RefreshNextReminderTimer(i,s,o)},e.RefreshNextReminderTimer=function(e,t,n){var a=this;window.clearInterval(i),n.sort(function(e,t){return e.ReminderItemDataModel.ReminderTime.compare(t.ReminderItemDataModel.ReminderTime)});var o=n.length>0?n[0]:null;o&&(i=window.setTimeout(function(){a.ActivateReminders(e,c.a.UTCNow,n)},o.ReminderItemDataModel.ReminderTime.toUTC().Subtract(t)))},e.ActivateReminders=function(t,n,i){var a,o=this;i=i.filter(function(e){return!(e.ReminderItemDataModel.ReminderTime.toUTC().compare(n)<=0)||(a=o.initalReminderNotification(e),t.dispatch(Object(p.a)(a)),!1)}),null!=a&&t.dispatch(Object(p.k)(i)),e.RefreshNextReminderTimer(t,n,i)},e.isVisibleReminderOverdue=function(e){return("string"==typeof e?c.a.parseISO8601DateTime(e):e).toUTC().addMinutes(15).compare(c.a.UTCNow)>=0},e}()},"110f05769e8b8b3d":function(e,t,n){e.exports={dropDrown:"_2_7QgfHUY6amhJ51UXRGc4",snoozeContextMenuItem:"_8zMefzNHHKZljzUAExbuh"}},"12d3d80075eba4ff":function(e,t,n){"use strict";var i,a=n("cce09edcbff44000"),o=n("f10d3ac77c67e555"),r=n("a15570f8ebd19e9e"),s=n("57554efb244a2e6c"),c=n("93cebf3bb203b06a");!function(e){e.New="New",e.Seen="Seen",e.Dismissed="Dismissed"}(i||(i={}));var l=n("59112cfb0e33e90b"),d=n("d2d530d8ddbc3f76");n.d(t,"a",function(){return m});var u="NewAppNotification",f="NewApp",p="/api/notifications",m=function(){function e(){}return e.getNewAppNotification=function(){Object(o.L)().dispatch(h(c.b.GET))},e.dismiss=function(e){Object(o.L)().dispatch(h(c.b.POST,e,i.Dismissed))},e.setSeen=function(e){Object(o.L)().dispatch(h(c.b.POST,e,i.Seen))},e.myAppsUrl="",e}();function h(e,t,n){return function(h,b,S){var g=t?{Status:n,IDs:t}:"";S.then(function(t){(function(e,t,n){return new Promise(function(i,a){e.Service.callWebClientShellServiceFunction(p,t,null,n).then(function(e){i(e)}).catch(function(e){c.h.isCallsBlockedException(e)||s.a.exception("NewAppProvider_CallNewAppNotificationAPI_Failed",6,e),a(e)})})})(t,e,g).then(function(e){var t=function(e,t){if(!e)return null;var n=e.Notifications,r=null;if(n&&n.length>0){var c=n.filter(function(e){return e.Type===f});c.length>0&&(r=function(e,t){var n=null,r=null,c=null,f=null,p=0;if(e.length>0&&null!=t&&t.length>0){var h,b=[];e.forEach(function(e){(h=function(e,t){if(t){var n=e.filter(function(e){return!!e.Id&&e.Id.substring(e.Id.indexOf("Shell")<0?0:5)===t.Payload});if(n.length>0)return a.__assign({},t,{LaunchFullUrl:n[0].LaunchFullUrl,Title:n[0].Title})}return null}(t,e))&&(b.push(h),e.Status===i.New&&p++)});var S=b.length;if(0===S)return null;1===S?(n=Object(o.I)(d.a.SingleNewAppTitle,b[0].Title),r=Object(o.I)(d.a.SingleNewAllMessage,b[0].Title),c=d.a.SingleNewAppAction,f=b[0].LaunchFullUrl?b[0].LaunchFullUrl:""):(n=d.a.MultipleNewAppTitle,b[0].Title&&b[1].Title&&(r=S<=3?Object(o.I)(2===S?d.a.MultipleTwoNewAppsMessage:d.a.MultipleThreeNewAppsMessage,b[0].Title,b[1].Title):Object(o.I)(d.a.MultipleFourNewAppsMessage,b[0].Title,b[1].Title,(S-2).toString())),c=d.a.MultipleNewAppAction,f=m.myAppsUrl);var g={ID:u,Title:n,Message:r,Type:l.a.NewAppNotification,LaunchFullUrl:f,ActionText:c,UnseenCount:p,AllNewAppIDs:b.map(function(e){return e.ID}),ItemID:0===S?b[0].ID:u},y={providerType:l.a.NewAppNotification,payload:g,toastState:0,toastType:3,navigationUrl:f};return p>0&&s.a.impression(l.a[l.a.NewAppNotification],s.f.FlexPane),y}return null}(c,t))}return r}(e,b().appsDataState.apps);null!=t&&h(Object(r.a)(t))}).catch(function(){})})}}},"178b38bb179b95cd":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("cce09edcbff44000"),a=n("c4daf14da52f3698"),o=n("f10d3ac77c67e555"),r=n("57554efb244a2e6c"),s=n("c8839b99e854a630"),c=n("31891470a74b0364"),l=n("d2d530d8ddbc3f76"),d=n("ac31c6d9df1a7d52"),u=n("3fb9153b1221be7b"),f=function(e){function t(t){var n=e.call(this,t)||this;return r.a.impression(r.g.NotificationSettings,r.f.NotificationSettingsPane),n.state={allowNotifications:Object(d.b)(n.props.chatFeatureEnabled,n.props.notificationPreferences)},n}return i.__extends(t,e),t.prototype.notificationKeyDown=function(e,t){switch(e.keyCode){case 13:case 32:this.toggleNotification(t),e.preventDefault(),e.stopPropagation()}},t.prototype.toggleNotification=function(e){if("allowNotifications"!==e){var t=this.props.notificationPreferences;this.mapKeyToPreferenceKey(e,t,!0),this.setState({allowNotifications:Object(d.b)(this.props.chatFeatureEnabled,t)}),this.logNotificationChange(e,t),this.props.onToggleNotification(e,this.props.chatFeatureEnabled,t)}else this.toggleAllowNotifications()},t.prototype.toggleAllowNotifications=function(){var e=!this.state.allowNotifications,t=this.props.notificationPreferences;t.EnableNewItemNotify=e,t.EnableNewItemSoundNotify=e,t.EnableReminders=e,t.EnableReminderSound=e,this.props.chatFeatureEnabled&&(t.EnableChat=e,t.EnableChatSound=e,t.EnableCalling=e,t.EnableCallingSound=e),this.setState({allowNotifications:e}),this.logNotificationChange("allowNotifications",t),this.props.onToggleAllowNotifications(this.props.chatFeatureEnabled,t)},t.prototype.render=function(){var e=this.state.allowNotifications?null:u.hidden,t=this.props.notificationPreferences;return a.createElement("div",{className:u.notificationsSubPanel},a.createElement("div",{className:Object(o.y)(u.settingHeader,s.e.neutral.dark.font)},l.a.NotificationSettings),this.buildNotificationSettingControl(Object(o.y)(u.notification),l.a.AllowNotifications,"allowNotifications",this.state.allowNotifications),a.createElement("div",{className:Object(o.y)(u.horizRule,s.e.neutral.light.background)}),this.props.chatFeatureEnabled&&a.createElement("div",null,this.buildNotificationSettingControl(Object(o.y)(e,t.EnableChat?null:u.lastNotificationSetting),l.a.ChatNotificationSetting,"chatNotification",t.EnableChat,l.a.ChatNotificationSettingLabel),this.buildNotificationSettingControl(Object(o.y)(e,u.lastNotificationSetting,t.EnableChat?null:u.hidden),l.a.ChatSoundNotificationSetting,"chatSoundNotification",t.EnableChatSound),this.buildNotificationSettingControl(Object(o.y)(e,t.EnableCalling?null:u.lastNotificationSetting),l.a.CallingNotificationSetting,"callingNotification",t.EnableCalling),this.buildNotificationSettingControl(Object(o.y)(e,u.lastNotificationSetting,t.EnableCalling?null:u.hidden),l.a.CallingSoundNotificationSetting,"callingSoundNotification",t.EnableCallingSound)),this.buildNotificationSettingControl(Object(o.y)(e,t.EnableNewItemNotify?null:u.lastNotificationSetting),l.a.NewMailNotificationSetting,"newItemNotification",t.EnableNewItemNotify,l.a.NewMailNotificationSettingLabel),this.buildNotificationSettingControl(Object(o.y)(e,u.lastNotificationSetting,t.EnableNewItemNotify?null:u.hidden),l.a.NewMailSoundNotificationSetting,"newItemSoundNotification",t.EnableNewItemSoundNotify),this.buildNotificationSettingControl(e,l.a.RemindersNotificationSetting,"reminderNotification",t.EnableReminders),this.buildNotificationSettingControl(Object(o.y)(e,u.lastNotificationSetting,t.EnableReminders?null:u.hidden),l.a.RemindersSoundNotificationSetting,"reminderSoundNotification",t.EnableReminderSound))},t.prototype.buildNotificationSettingControl=function(e,t,n,i,r){var l=this;return a.createElement("div",{role:"switch","aria-checked":i,className:Object(o.y)(u.notification,e),tabIndex:-1,onKeyDown:function(e){return l.notificationKeyDown(e,n)}},a.createElement("div",{className:Object(o.y)(u.notificationName,s.e.neutral.dark.font)},t),a.createElement(c.a,{id:n,ariaLabel:r||t,on:i,onNotificationToggled:function(){return l.toggleNotification(n)}}))},t.prototype.logNotificationChange=function(e,t){var n=this.mapKeyToPreferenceKey(e,t,!1);r.a.click(e,this.props.hostId,r.c.NotificationSettings,null,n.toString())},t.prototype.mapKeyToPreferenceKey=function(e,t,n){var i={status:!1};switch(e){case"allowNotifications":case"newItemNotification":t.EnableNewItemNotify=this.changedItem(n,t.EnableNewItemNotify,i);break;case"newItemSoundNotification":t.EnableNewItemSoundNotify=this.changedItem(n,t.EnableNewItemSoundNotify,i);break;case"reminderNotification":t.EnableReminders=this.changedItem(n,t.EnableReminders,i);break;case"reminderSoundNotification":t.EnableReminderSound=this.changedItem(n,t.EnableReminderSound,i);break;case"chatNotification":t.EnableChat=this.changedItem(n,t.EnableChat,i);break;case"chatSoundNotification":t.EnableChatSound=this.changedItem(n,t.EnableChatSound,i);break;case"callingNotification":t.EnableCalling=this.changedItem(n,t.EnableCalling,i);break;case"callingSoundNotification":t.EnableCallingSound=this.changedItem(n,t.EnableCallingSound,i)}return i.status},t.prototype.changedItem=function(e,t,n){return n.status=e?!t:t,n.status},t}(a.Component)},"189e4ee427d33dcc":function(e,t,n){e.exports={chatWindowWidth:"320",chatPopup:"_1Du-sk1qm7N29wolrAxll9",popupSlideIn:"_3ir2hjbmLx4JX6boZfPsmb",callout:"_-9lCX-OridX7Y0G-nUxNs",recentsWrapper:"_2XMXxZa6wCI-vnD4DhR5Fo"}},"2a336278accbeab0":function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"e",function(){return r}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var i=n("59112cfb0e33e90b"),a=n("4860b61820696c48"),o=2;function r(e,t,n){if(!e||0===e.length)return!1;switch(t){case 40:n.index++;break;case 38:n.index--;break;case 35:n.index=e.length;break;case 36:n.index=0;break;default:return!1}return n.index=n.index%e.length,n.index=n.index<0?0:n.index,n.selectedReminderId=e[n.index].payload.reminder.ReminderItemDataModel.ItemId,!0}function s(){var e=new Date;return e.getUTCFullYear().toString()+e.getUTCMonth().toString()+e.getUTCDate().toString()+e.getUTCHours().toString()+e.getUTCMinutes().toString()+e.getUTCSeconds().toString()+e.getUTCMilliseconds().toString()}function c(e,t){if(null==t||null==t.notificationPreferencesData||!t.notificationPreferencesData.EnableNewItemSoundNotify&&!t.notificationPreferencesData.EnableReminderSound&&!t.notificationPreferencesData.EnableChatSound&&!t.notificationPreferencesData.EnableCallingSound)return"";switch(e.providerType){case i.a.NewMailNotification:return null!=t.mailNotificationAudioUrl&&t.notificationPreferencesData.EnableNewItemSoundNotify?t.mailNotificationAudioUrl:"";case i.a.SystemAlert:return null!=t.systemNotificationAudioUrl?t.systemNotificationAudioUrl:"";case i.a.ReminderNotification:return null!=t.calendarNotificationAudioUrl&&t.notificationPreferencesData.EnableReminderSound?t.calendarNotificationAudioUrl:"";case i.a.ChatNotification:return e.subType===a.a.call?null!=t.callNotificationAudioUrl&&t.notificationPreferencesData.EnableCallingSound?t.callNotificationAudioUrl:"":null!=t.chatNotificationAudioUrl&&t.notificationPreferencesData.EnableChatSound?t.chatNotificationAudioUrl:"";default:return""}}function l(e,t,n){return e.filter(function(e){return n?e.payload.reminder.ReminderItemDataModel.ItemId===t:e.payload.reminder.ReminderItemDataModel.ItemId!==t})}function d(e,t){var n=e.filter(function(e){return e.providerType===i.a.ReminderNotification});return t?n.filter(function(e){return 3===e.toastState}):n.filter(function(e){return 3!==e.toastState})}},"2f489d700a85652e":function(e,t,n){"use strict";n.r(t);var i=n("182babe9e251f0d2"),a=n("f10d3ac77c67e555"),o=n("a15570f8ebd19e9e"),r=n("cce09edcbff44000"),s=n("c4daf14da52f3698"),c=n("2abb04ba65f54d21"),l=n("85548b60b933cd24"),d=n("de1b2f28103fc2e6"),u=n("bed867ddee695404"),f=n("c8839b99e854a630"),p=n("d546f7e5fb3e1213"),m=n("3b7479bd7099a597"),h=n("775fde3668a767ba"),b=n("189e4ee427d33dcc"),S=n("d2d530d8ddbc3f76"),g="chat_popup",y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.populateRecentsContent=function(e){e&&(t.props.isChatRecentsPaneInitialized?Object(p.f)(e):t.initializeRecents(e))},t.initializeRecents=function(e){t.props.isChatAPIInitialized?Object(p.a)(e,t.props.onRecentsReady):window.addEventListener(m.b.ChatAPIReady,function(){t.onChatAPIReady(e)})},t.onChatAPIReady=function(e){window.removeEventListener(m.b.ChatAPIReady,function(){t.onChatAPIReady(e)}),Object(p.a)(e,t.props.onRecentsReady)},t.onAnimationEnd=function(){var e=document.getElementById(g);e&&e.focus()},t}return r.__extends(t,e),t.prototype.getPopupPosition=function(){var e,t=parseInt(b.chatWindowWidth);if(this.chatHeaderButton){var n=this.chatHeaderButton.offsetLeft+1.5*this.chatHeaderButton.offsetWidth-t/2;e=this.chatHeaderButton.offsetParent&&n+t>this.chatHeaderButton.offsetParent.clientWidth+this.chatHeaderButton.offsetWidth?{right:10}:n<0?{left:10}:{left:n}}else e={right:10};return this.props.isThinHeader&&(e=r.__assign({},e,{top:this.props.isThinHeader?48:50})),e},t.prototype.render=function(){var e;return s.createElement(a.j,{onDismiss:this.props.onDismiss,ariaLabel:S.a.ChatOpened,role:"region",className:Object(a.y)(b.chatPopup,(e={},e[b.popupSlideIn]=this.props.isChatRecentsPaneOpen,e)),popupPosition:this.getPopupPosition(),target:this.chatHeaderButton,id:g,onAnimationEnd:this.onAnimationEnd},s.createElement("div",{"data-style":"o365shell",className:Object(a.y)(m.a.ChatRecents,b.recentsWrapper),ref:this.populateRecentsContent,id:"chat_recent_pane"}))},t.prototype.componentDidUpdate=function(){this.chatHeaderButton||(this.chatHeaderButton=document.getElementById(h.CHAT_BTN_ID))},t.prototype.componentDidMount=function(){window.addEventListener(a.f.RESIZE,this.props.onDismiss),window.addEventListener(a.f.SCROLL,this.props.onDismiss)},t.prototype.componentWillUnmount=function(){window.removeEventListener(a.f.RESIZE,this.props.onDismiss),window.removeEventListener(a.f.SCROLL,this.props.onDismiss)},t}(s.Component),I=n("9bcc53b668a4b1e0"),N=Object(i.b)(function(e){return{isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneInitialized:e.chatState.isChatRecentsPaneInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isThinHeader:c.O365Shell.RenderSettings.isThinHeader}},function(e){return{onRecentsReady:function(){e(Object(I.b)(!0))},onDismiss:function(t){var n=document.getElementById(h.CHAT_BTN_ID);t instanceof MouseEvent&&t.target&&n&&n.contains(t.target)||e(Object(I.c)(!1))}}})(y),C=n("cacee1ed123803fb"),v=n("04567c0fa98bd173");var T,O,E,A,_=function(){var e=Object(c.createDivElement)(Object(a.y)(m.a.ChatWrapper,v.wrapperStyle),"chat_wrapper_pane");return document.body.appendChild(e),e},w=n("57554efb244a2e6c"),P=n("6979bf6f75c9726d"),D=document.getElementById(l.a),R=""+a.P.hidden,x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userPresenceStatusUpdate=function(e,n){if(t.props.userPresenceStatusItems){var i=Object(P.b)(n,t.props.userPresenceStatusItems);t.props.userPresenceStatusUpdate(i)}t.presenceStatusKey=n},t.onPresenceStatusChanged=function(e){var n=t.props.presenceStatus,i=Object(P.b)(e,t.props.userPresenceStatusItems);Object(p.i)(i,function(){w.a.exception("Chat API setUserPresenceStatus failed",6,null),t.props.userPresenceStatusUpdate(n)})},t.onChatClickHandler=function(e){e instanceof KeyboardEvent&&e.type===a.f.KEYDOWN&&13!==e.which&&40!==e.which||(e.preventDefault(),w.a.click(w.d.ChatButton,w.b.Chat,null,null,"Chat recents list open "+!t.props.isChatRecentsPaneOpen),t.props.onRecentsOpen(!t.props.isChatRecentsPaneOpen,h.CHAT_BTN_ID))},t.onNotificationReceived=function(e){var n=e;if(n){var i=t.props.chatNotificationsEnabled&&(n.type===d.a.message||n.type===d.a.summary);if(t.props.callingNotificationsEnabled&&n.type===d.a.call||i||t.props.isConsumerShell){var a={type:n.type,title:n.title,description:n.description,actionLink:n.actions.length>0?n.actions[0]:null,cancelLink:n.actions.length>1?n.actions[1]:null,image:n.avatarUrl,sender:n.sender,id:n.id},o={providerType:d.b.ChatNotification,subType:n.type,payload:a,toastType:n.type===d.a.call?1:0,toastState:0};t.props.onNotificationReceived(o),w.a.impression(n.type,w.f.Chat)}}},t.onStartChat=function(){t.props.onRecentsOpen(!1,h.CHAT_BTN_ID),w.a.impression(w.g.ChatWindow,w.f.Chat)},t.onChatNotificationSettingsUpdated=function(e){var n=e;if(n){var i=Object(p.d)(n.value);switch(n.name){case m.e.NewMessage:t.updateChatSettings(i);break;case m.e.IncomingCall:t.updateCallSettings(i)}}},t}return r.__extends(t,e),t.prototype.render=function(){return this.props.chatEnabled&&this.props.isChatAPIInitialized?s.createElement(N,null):null},t.prototype.componentDidMount=function(){this.props.chatEnabled&&!this.props.isChatAPIInitialized&&this.beginChatInitialization()},t.prototype.beginChatInitialization=function(){var e=this;T=function(){e.onChatCoreReady()},O=function(){e.onChatAPIReady()},window.addEventListener(m.b.ChatCoreReady,T),window.addEventListener(m.b.ChatAPIReady,O),this.appendChatAPIDownloadScript()},t.prototype.onChatCoreReady=function(){var e=this;window.removeEventListener(m.b.ChatCoreReady,T);var t=this.getInitParams();swc&&t?swc.init(null,t).catch(function(t){window.removeEventListener(m.b.ChatAPIReady,O),e.handleAPIInitializationError(t)}):(window.removeEventListener(m.b.ChatAPIReady,O),this.handleAPIInitializationError())},t.prototype.onChatAPIReady=function(){window.removeEventListener(m.b.ChatAPIReady,O),this.initializeChat()},t.prototype.initializeChat=function(){var e=this;try{this.props.disableToasts||(swc.API.registerEvent(m.b.ApiReceivedNotification,this.onNotificationReceived),swc.API.registerEvent(m.b.ApiHideNotification,this.props.onNotificationDismissed)),swc.API.registerEvent(m.b.ApiUnreadConversationUpdate,this.props.onUnreadConversationUpdate),swc.API.registerEvent(m.b.ApiStartChat,this.onStartChat),swc.API.registerEvent(m.b.ApiOnCallStart,function(){w.a.impression(w.g.CallStart,w.f.Chat)}),swc.API.registerEvent(m.b.ApiOnRecentItemSelected,function(){w.a.click(w.d.ChatRecentItem,w.b.Chat)}),swc.API.registerEvent(m.b.ApiRecentsShown,this.startChatLoadingTime),swc.API.registerEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.registerEvent(m.b.ApiSettingsChanged,this.onChatNotificationSettingsUpdated),swc.create(m.c.Messaging,p.e,_()),swc.getPresence().then(function(t){t.getMyStatus().then(function(t){t?e.userPresenceStatusUpdate(e.props.userId,t):w.a.tag("Presence_API_getMyStatus_Undefined",6)}).catch(function(e){w.a.exception("Presence_API_getMyStatus_Failed",6,e)}),t.subscribeToUserStatus(e.props.userId,e.userPresenceStatusUpdate),t.getStatusList().then(function(t){Object(a.gb)(t)?(e.props.onUserPresenceStatusListUpdate(t),e.presenceStatusKey&&(e.userPresenceStatusUpdate(e.props.userId,e.presenceStatusKey),e.presenceStatusKey=void 0)):w.a.tag("Presence_API_getStatusList_Invalid",6)}).catch(function(e){w.a.exception("Presence_API_getStatusList_Failed",6,e)})}).catch(function(e){w.a.exception("Presence_API_Initialization_Failed",6,e)}),w.a.impression(w.g.ChatApi_Init,w.f.Chat,0,void 0,"successful"),this.onChatAPIInitialized(!0)}catch(e){this.handleAPIInitializationError(e)}},t.prototype.handleAPIInitializationError=function(e){w.a.exception("Chat_API_Initialization_Failed",6,e),this.onChatAPIInitialized(!1),this.props.responsiveEnabled||D&&this.props.isConsumerShell&&Object(c.toggleClassList)(D,R,!1)},t.prototype.getInitParams=function(){var e={toLoadUnreadConversationsCount:!0,locale:this.props.locale,correlationId:this.props.correlationId};return this.props.isConsumerShell?e:this.props.getAccessTokenforResource?r.__assign({tokenProvider:this.props.getAccessTokenforResource,tokenType:"aad"},e):null},t.prototype.onChatAPIInitialized=function(e){if(this.props.onChatAPIInitialized(e),e&&!this.props.responsiveEnabled){var t=document.getElementById(h.CHAT_BTN_ID);t&&(Object(a.U)(t,a.f.CLICK+" "+a.f.KEYDOWN,C.b),Object(a.t)(t,a.f.CLICK+" "+a.f.KEYDOWN,this.onChatClickHandler),Object(c.toggleClassList)(D,R,!1))}u.CallbackManager.subscribe("ThemeChanged",function(){if(f.b.Instance){var e=f.b.Instance.UserThemesManager.isDarkTheme?"dark":f.b.Instance.UserThemesManager.CurrentThemeId;swc.setTheme(e)}},!0),u.CallbackManager.subscribe("PresenceStatusChanged",this.onPresenceStatusChanged,!1),this.updateNotificationSettings()},t.prototype.appendChatAPIDownloadScript=function(){var e=this;E=function(){e.onChatAPIDownloadScriptFailed()};var t=document.createElement("script");t.type="text/javascript",t.setAttribute("data-style","o365shell"),t.setAttribute("data-disable-autostart","true"),t.setAttribute("data-platform-id",this.props.workloadId),t.setAttribute("data-auth-type",this.props.isConsumerShell?"msa":"aad"),t.src=this.props.chatSDKUrl,t.onerror=E,document.head.appendChild(t)},t.prototype.onChatAPIDownloadScriptFailed=function(){w.a.exception("Chat API download script failed",6,null),this.props.onChatAPIInitialized(!1),this.props.responsiveEnabled||this.props.isConsumerShell&&Object(c.toggleClassList)(D,R,!1)},t.prototype.startChatLoadingTime=function(){A=Date.now()},t.prototype.logChatLoadingTime=function(){A&&(w.a.timer("Chat_FirstTimeChatListShown",Date.now()-A),swc.API.unregisterEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.unregisterEvent(m.b.ApiRecentsShown,this.startChatLoadingTime))},t.prototype.updateNotificationSettings=function(){var e=this;Object(p.c)().then(function(t){e.updateChatSettings(t)}).catch(function(){}),Object(p.b)().then(function(t){e.updateCallSettings(t)}).catch(function(){})},t.prototype.updateChatSettings=function(e){var t=this.props.notificationPreferences;t.EnableChat=e.Enabled,t.EnableChatSound=e.SoundEnabled,this.props.onNotificationPreferencesUpdated(t)},t.prototype.updateCallSettings=function(e){var t=this.props.notificationPreferences;t.EnableCalling=e.Enabled,t.EnableCallingSound=e.SoundEnabled,this.props.onNotificationPreferencesUpdated(t)},t}(s.Component),k=n("b9612831b8d47cda");n.d(t,"mapStateToProps",function(){return j}),n.d(t,"ChatBaseControlConnector",function(){return M});var j=function(e){var t=e.shellInitDataState;return{getAccessTokenforResource:t.renderSettings.GetAccessTokenforResource,disableToasts:t.renderSettings.disableToasts,locale:e.shellInitDataState.navBarData.CultureName,notificationsEnabled:e.shellInitDataState.clientData.NotificationsEnabled,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,correlationId:e.shellInitDataState.clientData.SHSID,responsiveEnabled:null!=e.shellInitDataState.layout,chatEnabled:e.chatState.chatEnabled,chatSDKUrl:e.chatState.webChatSDKUrl,isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,chatNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableChat,callingNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableCalling,userId:t.clientData.PUID,workloadId:t.clientData.WorkloadId,presenceStatus:e.meControlState.userPresenceStatus,userPresenceStatusItems:e.meControlState.userPresenceStatusItems,notificationPreferences:e.notificationState&&e.notificationState.notificationPreferencesData||null}},M=Object(i.b)(j,function(e){return{onChatAPIInitialized:function(t){e(Object(I.a)(t))},onRecentsOpen:function(t,n){e(Object(I.c)(t)),e(Object(a.N)(n))},onNotificationDismissed:function(t){e(Object(o.e)(t))},onNotificationReceived:function(t){e(Object(o.a)(t))},onUnreadConversationUpdate:function(t){e(Object(I.d)(t))},userPresenceStatusUpdate:function(t){e(Object(k.g)(t))},onUserPresenceStatusListUpdate:function(t){e(Object(k.h)(t))},onNotificationPreferencesUpdated:function(t){e(Object(a.fb)(t))}}})(x)},"31891470a74b0364":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("cce09edcbff44000"),a=n("c4daf14da52f3698"),o=n("f10d3ac77c67e555"),r=n("c8839b99e854a630"),s=n("0290f4e8302ad778"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e,t=this;return a.createElement("button",{id:this.props.id,className:Object(o.y)(s.toggleBackground,this.props.on?s.toggleOn+" "+r.e.neutral.accent.background:s.toggleOff+" "+r.e.neutral.lighterAlt.background+" "+r.e.neutral.dark.border),tabIndex:0,"aria-label":this.props.ariaLabel,role:"switch","aria-checked":this.props.on,onClick:function(){return t.props.onNotificationToggled(!t.props.on)}},a.createElement(o.h,{fontIconCss:Object(o.y)("ms-Icon--ToggleThumb",(e={},e[r.e.neutral.lighterAlt.font]=this.props.on,e))}))},t}(a.Component)},"36db2dbbda25426d":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var i,a=n("0d05d74f4c592f54"),o=n("63b82e6cd6c36214"),r=n("97e1e62fe098b84a"),s=7*a.a,c=((i={}).default=!0,i.en=!0,i["am-ET"]=!0,i["bg-BG"]=!0,i["bn-IN"]=!0,i["ca-ES"]=!0,i["cz-CZ"]=!0,i["cy-GB"]=!0,i["da-DK"]=!0,i["de-DE"]=!0,i["el-GR"]=!0,i["en-029"]=!0,i["en-AU"]=!0,i["en-BZ"]=!0,i["en-CA"]=!0,i["en-GB"]=!0,i["en-IE"]=!0,i["en-IN"]=!0,i["en-JM"]=!0,i["en-MY"]=!0,i["en-NZ"]=!0,i["en-PH"]=!0,i["en-SG"]=!0,i["en-TT"]=!0,i["en-US"]=!0,i["en-ZA"]=!0,i["en-ZW"]=!0,i["es-ES"]=!0,i["es-MX"]=!0,i["et-EE"]=!0,i["eu-ES"]=!0,i["fi-FI"]=!0,i["fr-BE"]=!0,i["fr-CA"]=!0,i["fr-CH"]=!0,i["fr-FR"]=!0,i["fr-LU"]=!0,i["fr-MC"]=!0,i["gl-ES"]=!0,i["gu-IN"]=!0,i["hi-IN"]=!0,i["hr-HR"]=!0,i["hu-HU"]=!0,i["id-ID"]=!0,i["is-IS"]=!0,i["it-IT"]=!0,i["kk-KZ"]=!0,i["kn-IN"]=!0,i["lt-LT"]=!0,i["lv-LV"]=!0,i["ms-MY"]=!0,i["nb-NO"]=!0,i["nl-NL"]=!0,i["pl-PL"]=!0,i["pt-BR"]=!0,i["pt-PT"]=!0,i["ro-RO"]=!0,i["ru-RU"]=!0,i["sk-SK"]=!0,i["sl-SI"]=!0,i["sv-SE"]=!0,i["ta-IN"]=!0,i["te-IN"]=!0,i["tr-TR"]=!0,i["uk-UA"]=!0,i["vi-VN"]=!0,i),l=function(){function e(){}return e.ConvertToDateTime=function(e){var t=new Date(e.year,e.month,e.date,e.hour).getTimezoneOffset()*a.c,n=e.GetMilliseconds()+t;return new Date(n)},e.GetShortTime=function(t){var n=null,i=null;o.a.Instance.is24HourFormat?i="H":(i="h",n=c[o.a.Instance.userCulture]?"t":"tt",n="t");var a=o.a.Instance.timeFormat,s=e.ConvertToDateTime(t),l=r(s,i);l=l+e.GetTimeSeparator(a)+r(s,"MM");var d=null==n?"":r(s,n);return 0===a.indexOf("tt")?d+l:l+d},e.GetTimeSeparator=function(e){var t=null;if(-1!==e.indexOf("'h'"))return"'h'".replace("/'+/g","");if(-1!==e.indexOf("' h '"))return"' h '".replace("/'+/g","");var n=e.split(new RegExp("[hH]+"));return null!=n&&n.forEach(function(e){e.length>1&&(t=e.substring(0,1))}),t},e}()},"38b43ea403549748":function(e,t,n){e.exports={mailText:"_23jlgUCHYeDPVktFgRU_Ps",sender:"_1aya4qubfpsxKmGhij924N",mailSubject:"_3M_ntHpB8nps78Mxg4ZZsr",mailIcon:"_1e_2lyfZPjYe46HsgyMr6O",bodyPreviewText:"_5WnG_YFJvqdp1FsNih_9h",newMailPopupButton:"_1ctZ_aecZCfeW2Gxo-2-OJ",newMailPopupButtonCell:"_3GwOLbGulwQnBl9w0CZXg0",itemContent:"_3i1iwOJ3Z5SRRoT6We-RON",newMailPersonaImage:"CaMY9bCNrtqEckObvMTrO",newFlexPaneNewMailNotification:"_1Dl8PzVnSOIUq8qgLeLk9C",newMailLink:"_3pkMlc4fjuSobUQH2vcXuX",condensed:"WT4NdXyBgdPpoxAStxha1",condensedIcon:"G_5kNW7wrFd-_BToRsqaK",condensedMailText:"tlDlRiI9UrnWQmUN2XIa4"}},"3fb9153b1221be7b":function(e,t,n){e.exports={settingHeader:"_3Lpkbzesaz8pKOBU2AJdD6",notificationsSubPanel:"zPO5HKjYVrwsxr1CEiB9x",notification:"_1kPP_5iQNq2zfsQvkZT-zg",lastNotificationSetting:"_1NUjob1RT6IJghYQjnGft5",notificationName:"_3aEZlgRE1L-OBJwKdNkcSy",hidden:"_1CGdr4_vKd8X7XgXzkbE8z",horizRule:"_30i6kCiz-wBQ4_aQC6uowB"}},"46671b7a418f01a5":function(e,t,n){e.exports={icon:"RWDo_jxuWRdSQAairRMpO",button:"_1pCN2RpaRbRJVscwVJkve_",unseenitems:"_ap5XDMe4b60M3TXOPNN8",unseenCount:"_249pcYYDaHsYZQhuesnP8w",unseenCountBorder:"_27CBUvFT__NLxdFlHozr_b",unseenCountOval:"_3LtybsuZ6liegr3a036Xzq"}},"468f118279816314":function(e,t,n){"use strict";var i=n("57554efb244a2e6c"),a=n("f10d3ac77c67e555"),o=n("ac31c6d9df1a7d52"),r=n("93cebf3bb203b06a"),s="Chat Settings Instance not available",c=function(){function e(){}return e.getNotificationForChatSetting=function(e){return new Promise(function(t,n){if(o.a){var a=null;o.a.getChatNotificationSettings().then(function(n){a=Object(o.e)(n,e),t(a)}).catch(function(e){i.a.exception("Settings_GetNotificationPreferencesForChatFromChatApi_Failed",6,e),n(e)})}else n(new r.a(s))})},e.getNotificationForCallingSetting=function(e){return new Promise(function(t,n){if(o.a){var a=null;o.a.getCallNotificationSettings().then(function(n){a=Object(o.d)(n,e),t(a)}).catch(function(e){i.a.exception("Settings_GetNotificationPreferencesForCallingFromChatApi_Failed",6,e),n(e)})}else n(new r.a(s))})},e.setChatNotificationPreferences=function(e){var t={Enabled:e.EnableChat,SoundEnabled:e.EnableChatSound};return o.a?o.a.setChatNotificationSettings(t):Promise.reject(new r.a(s))},e.setCallingNotificationPreferences=function(e){var t={Enabled:e.EnableCalling,SoundEnabled:e.EnableCallingSound};return o.a?o.a.setCallNotificationSettings(t):Promise.reject(new r.a(s))},e}(),l=function(){function e(){}return e.setNotificationSetting=function(e,t,n,a){"newItemNotification"!==t&&"newItemSoundNotification"!==t&&"reminderNotification"!==t&&"reminderSoundNotification"!==t||e.Settings.setNotificationPreferences(a).catch(function(e){i.a.exception("Settings_setNotificationPreferences_Failed",6,e)}),!0===n&&("chatNotification"!==t&&"chatSoundNotification"!==t||c.setChatNotificationPreferences(a).catch(function(e){i.a.exception("Settings_setChatNotificationPreferences_Failed",6,e)}),"callingNotification"!==t&&"callingSoundNotification"!==t||c.setCallingNotificationPreferences(a).catch(function(e){i.a.exception("Settings_setCallingNotificationPreferences_Failed",6,e)}))},e.setToggleAllowNotifications=function(e,t,n){e.Settings.setNotificationPreferences(n).catch(function(e){i.a.exception("Settings_setNotificationPreferences_Failed",6,e)}),t&&(c.setChatNotificationPreferences(n).catch(function(e){i.a.exception("Settings_setChatNotificationPreferences_Failed",6,e)}),c.setCallingNotificationPreferences(n).catch(function(e){i.a.exception("Settings_setCallingNotificationPreferences_Failed",6,e)}))},e}(),d=n("305519d787d3c384");function u(e){return function(t,n,a){a.then(function(n){n.Settings.getLanguageChoices().then(function(n){t(Object(d.h)(n)),t(function(e){return function(t,n,a){a.then(function(n){n.Settings.getLanguageAndTimeZone().then(function(a){if(t(Object(d.g)(a.CurrentCultureName)),e)n.Settings.getTimeZoneChoices().then(function(e){t(Object(d.u)(e)),t(Object(d.t)(a.CurrentTimeZone,a.CurrentDateFormat,a.CurrentTimeFormat));var n={locale:a.CurrentCultureName,timezone:a.CurrentTimeZone,dateformat:a.CurrentDateFormat,timeformat:a.CurrentTimeFormat};i.a.impression(i.g.LanguageAndRegionCard_InitialValues,i.f.SettingsCard,0,void 0,JSON.stringify(n))}).catch(function(e){return i.a.exception("Settings_getTimeZoneChoices_Failed",6,e)});else{var o={locale:a.CurrentCultureName};i.a.impression(i.g.LanguageAndRegionCard_InitialValues,i.f.SettingsCard,0,void 0,JSON.stringify(o))}}).catch(function(e){i.a.exception("Settings_getLanguageAndTimeZone_Failed",6,e)})})}}(e))}).catch(function(e){return i.a.exception("Settings_getLanguageChoices_Failed",6,e)})})}}function f(e){return function(t,n,i){return new Promise(function(n,a){i.then(function(i){i.Settings.setLanguageAndTimeZone(e).then(function(){t(Object(d.l)()),n()}).catch(a)})})}}function p(e,t,n){return function(a,o,r){r.then(function(o){o.Settings.getDateTimeFormats(e).then(function(e){a(Object(d.d)(e.DateFormats)),a(Object(d.s)(e.TimeFormats));var i=e.DateFormats.some(function(e){return e===t}),o=e.TimeFormats.some(function(e){return e===n});i||""===t||a(Object(d.m)(e.DateFormats[0])),o||""===n||a(Object(d.o)(e.TimeFormats[0]))}).catch(function(e){i.a.exception("Settings_getDateTimeFormats_Failed",6,e)})})}}function m(){return function(e,t,n){n.then(function(t){t.Settings.loadUserThemeChoices().then(function(t){e(Object(a.eb)(t))}).catch(function(e){i.a.exception("Settings_loadUserThemeChoices_Failed",6,e)})})}}function h(e,t){return function(n,a,o){n(Object(d.r)(e)),o.then(function(a){a.Settings.setLandingPage(e).catch(function(e){n(Object(d.r)(t)),i.a.exception("Settings_setLandingPage_Failed",6,e)})})}}function b(e){return function(t,n,a){a.then(function(n){n.Settings.getLandingPage().then(function(n){t(null!=n&&""!==n?Object(d.r)(n):h(d.a,e))}).catch(function(e){i.a.exception("Settings_getLandingPage_Failed",6,e)})})}}function S(e,t){return function(n,o,r){r.then(function(o){o.Settings.getNotificationPreferences(e).then(function(e){t?c.getNotificationForChatSetting(e).then(function(e){c.getNotificationForCallingSetting(e).then(function(e){i.a.impression(i.g.NotificationsCard_InitialValue,i.f.SettingsCard,0,void 0,JSON.stringify(e)),n(Object(a.fb)(e))})}):n(Object(a.fb)(e))})})}}function g(e,t){return function(n,i,o){o.then(function(i){n(Object(a.fb)(t)),l.setToggleAllowNotifications(i,e,t)})}}function y(e,t,n){return function(i,o,r){r.then(function(o){i(Object(a.fb)(n)),l.setNotificationSetting(o,e,t,n)})}}n.d(t,"a",function(){return u}),n.d(t,"f",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return S}),n.d(t,"i",function(){return g}),n.d(t,"h",function(){return y})},"47c425cb724166f8":function(e,t,n){e.exports={o365cs:"_3YVYAa9qfodxztQGKnh2pJ",toastSlot:"_1BdWvc4Ysp8El2yHkwl8JL",header:"_1hM2l9Uym0-w4FyBos_t6H",chevronDiv:"_3ytzn4a6Fu1SmhBYzazlFt",toastScrollRegion:"sIVERhhGZpTv27XfW0UTd",footer:"_33z9pgmO7dKdETEvzaM7L-",notificationsContent:"_3N6s3f3fG-MtyI2Ynh2JMo",label:"_1jOsHZg1kWeTQz-P-OlQDz",reminderBox:"_1dqFZKDRhtnLWNiTwH0cS6",headerCloseButton:"jbOwdYQ1weQwe5iCj9jTS"}},"54be359eb09e7f40":function(e,t,n){e.exports={flexPaneSidePadding:"_1ng_qkaqPtGydVsNgq3nJs",itemTitle:"AL0ZK4LnVJNzQsGtwWlCv",backButton:"_1oB23MYTtnxyj36_Yhjm3z",backIcon:"fjjbHHeqIzTebxSFxJY45",mainContainer:"_2bunsCoW2CUCC7pmACzfVK",container:"_1YRQGjmiq951YrBtcGlf3C",customizeLinkContainer:"_2p84_l938Im8ZpbP8mGcFR",customizeSettingsLink:"zZlMmvLanNVm6AWkGMacw",settingsContainer:"_4wAHgdJRFm7s4Ty7SvrPM",notificationTitle:"_2RGK4KIxqCKU4tsSsmUHr",section:"_2Ioj7vIw3oPqPdo1F4LCvu",notificationsMessage:"_1yCT6i83AcUV2_Aa1dS5F3",notificationsDisabled:"_1AtMsnqNN6HRWUVMOiChJD",countLabel:"_3pOCMVmSIdmJJoWQXcYxDx",emptyState:"_2JGH3F3Wisp32e0VAvRTdY",imgEmptyState:"_1KbVBTNiEj0sNWi7-oFVdx"}},"6d2c591331761015":function(e,t,n){"use strict";var i=n("0e6a3e4aca161152");n.d(t,"c",function(){return i.a});n("36db2dbbda25426d");var a=n("0d05d74f4c592f54");n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return a.c})},"7bd3263b26b48094":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("57554efb244a2e6c"),a=n("bed867ddee695404"),o=n("0d05d74f4c592f54"),r=n("0e6a3e4aca161152"),s=n("36db2dbbda25426d"),c=n("9f13d46e2e6ab2a9"),l=n("f3174af274c7b4a8"),d=n("59112cfb0e33e90b"),u=n("d4dd8e7f960da628"),f=n("d2d530d8ddbc3f76"),p=function(){function e(t){this.reminderItemDataModel=null,this.isReminderOverdue=!1,this.reminderItemDataModel=t,this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime(),0!==this.reminderItemDataModel.ReminderGroup&&1!==this.reminderItemDataModel.ReminderGroup&&Object(c.a)(Object(l.b)("Invalid value {0} for reminder group",this.reminderItemDataModel.ReminderGroup))}return Object.defineProperty(e.prototype,"ReminderItemDataModel",{get:function(){return this.reminderItemDataModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsReminderOverdue",{get:function(){return this.isReminderOverdue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartValue",{get:function(){return this.timeToStartValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartUnit",{get:function(){return this.timeToStartUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeLabel",{get:function(){var t="";return 0===this.reminderItemDataModel.ReminderGroup?t=r.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.referenceDateTime)&&r.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.reminderItemDataModel.EndDate)?Object(l.b)("{0} - {1}",s.a.GetShortTime(this.reminderItemDataModel.StartDate),s.a.GetShortTime(this.reminderItemDataModel.EndDate)):e.GetLongDateTimeString(this.reminderItemDataModel.StartDate):1===this.reminderItemDataModel.ReminderGroup&&(t=s.a.GetShortTime(this.reminderItemDataModel.ReminderTime)),t},enumerable:!0,configurable:!0}),e.prototype.UpdateReferenceTimeFromNow=function(){this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime()},e.prototype.UpdateReferenceTime=function(t){this.referenceDateTime=e.GetReferenceTime(t),this.UpdateTimeToStartFromReferenceTime()},e.GetLongDateTimeString=function(t){var n=s.a.GetShortTime(t),i=e.daysOfTheWeek[s.a.ConvertToDateTime(t).getDay()],a=e.monthsOfTheYear[t.month],o=t.date.toString(),r=t.year.toString();return Object(l.b)("{0} {1}, {2} {3}, {4}",n,i,a,o,r)},e.prototype.UpdateTimeToStartFromReferenceTime=function(){var e=this.GetTimeToStartInMillis(),t=this.GetDurationInfo(Math.abs(e));this.isReminderOverdue=Math.floor(e/o.c)<0,this.timeToStartValue=t[0],this.timeToStartUnit=t[1]},e.prototype.GetTimeToStartInMillis=function(){var e=null;return 0===this.reminderItemDataModel.ReminderGroup?e=this.reminderItemDataModel.StartDate:1===this.reminderItemDataModel.ReminderGroup&&(e=this.reminderItemDataModel.ReminderTime),e.Subtract(this.referenceDateTime)},e.prototype.GetTimeToEndInMillis=function(){var e=null;if(0===this.reminderItemDataModel.ReminderGroup)e=this.reminderItemDataModel.EndDate;else{if(1!==this.reminderItemDataModel.ReminderGroup)return 0;e=this.reminderItemDataModel.ReminderTime}return e.Subtract(this.referenceDateTime)},e.prototype.OpenItem=function(e,t){i.a.click(i.d.NotificationClick,i.b.NotificationToast,d.a[d.a.ReminderNotification]);var n="",o=null,r=t.indexOf("?")>-1?"&":"?",s=this.reminderItemDataModel.ReminderGroups;1==(1&s)?o=4==(4&s)?"IBirthdayFactory":"ICalendarItemDetailsViewModelFactory":2==(2&s)&&(o="TaskReadingPaneViewModelPopOutFactory");n=Object(a.isOwa)(e)?Object(l.b)("{0}{1}path=/owa&viewmodel={2}&ispopout=1&ItemID={3}",t,r,o,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)):Object(l.b)("{0}{1}path=/owa&ItemID={2}",t,r,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)),Object(u.a)(n)},e.prototype.GetDurationInfo=function(e){var t=0,n=f.a.Now_Title;return e>=s.b?n=1===(t=Math.floor(e/s.b))?f.a.Week_Title:f.a.Weeks_Title:e>=o.a?n=1===(t=Math.floor(e/o.a))?f.a.Day_Title:f.a.Days_Title:e>=o.b?n=1===(t=Math.floor(e/o.b))?f.a.Hour_Title:f.a.Hours_Title:e>=o.c&&(n=1===(t=Math.floor(e/o.c))?f.a.Min_Title:f.a.Mins_Title),[t>0?t.toString():"",n]},e.GetReferenceTimeFromNow=function(){var t=r.a.Now;return e.GetReferenceTime(t)},e.GetReferenceTime=function(e){return new r.a(e.year,e.month,e.date,e.hour,e.minute,0,0,0)},e.daysOfTheWeek=[f.a.Sunday_Title,f.a.Monday_Title,f.a.Tuesday_Title,f.a.Wednesday_Title,f.a.Thursday_Title,f.a.Friday_Title,f.a.Saturday_Title],e.monthsOfTheYear=[f.a.January_Title,f.a.February_Title,f.a.March_Title,f.a.April_Title,f.a.May_Title,f.a.June_Title,f.a.July_Title,f.a.August_Title,f.a.September_Title,f.a.October_Title,f.a.November_Title,f.a.December_Title],e}()},"840e18fc06f1ddd7":function(e,t,n){e.exports={container:"_3QCgb15CaZDustgwapm6vo",alertIcon:"YqBX1dsujbFqALdBNtNpq",alertPaneIcon:"_2RcZj4db6Lg0U56YAi61gI",text:"y8e6oOdk1_fApCJdRjqZZ",message:"_3lEMS-t4-E2MzMt9BYPrzX",title:"_4uUHDO3s1APWh2si3ApCE",actionText:"_3RCYnZ4kJH2q88kR0wEldI",systemClose:"_1EMhQXc1u6hnFb_BppAPRy"}},a15570f8ebd19e9e:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"g",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return S}),n.d(t,"c",function(){return g}),n.d(t,"h",function(){return y}),n.d(t,"k",function(){return I}),n.d(t,"i",function(){return N}),n.d(t,"j",function(){return C});var i=n("93cebf3bb203b06a"),a=n("57554efb244a2e6c"),o=n("0e6a3e4aca161152"),r=n("de36ca360c354767"),s=n("59112cfb0e33e90b"),c=n("bb16b7a2469e91b3"),l=n("d619b17cc30e6342"),d=n("12d3d80075eba4ff");function u(e){return function(t,n){t({type:r.a,payload:e}),c.a.Add(n().notificationState.notifications)}}function f(e,t,n){return function(i,a){i({type:r.k,isRemoved:e,reminder:t,id:n}),c.a.Add(a().notificationState.notifications)}}function p(e,t,n,i){return function(a,o){a({type:r.g,ids:e,toastStatus:t,isCondensed:n,condensedCount:i}),c.a.Add(o().notificationState.notifications)}}function m(){return function(e,t){e({type:r.f});var n=t().notificationState.notifications,i=t().notificationState.notifications.filter(function(e){return 3!==e.toastState&&e.providerType===s.a.NewAppNotification&&null!=e.payload});c.a.Add(n),i.length>0&&d.a.setSeen(i[0].payload.AllNewAppIDs)}}function h(e,t){return function(n,s,l){n({type:r.d,providerType:e}),l.then(function(e){c.a.Add(s().notificationState.notifications),e.Calendar.dismissReminders(t,o.a.timeZone).catch(function(e){i.h.isCallsBlockedException(e)||a.a.exception("Notifications_DismissAllReminders_Failed",6,e)})})}}function b(e,t){return function(n,s,l){n({type:r.e,id:e}),l.then(function(e){null!=t&&e.Calendar.dismissReminders([t],o.a.timeZone).catch(function(e){i.h.isCallsBlockedException(e)||a.a.exception("Notifications_DismissReminder_Failed",6,e)}),c.a.Add(s().notificationState.notifications)})}}function S(e){return{type:r.b,notifications:e}}function g(e){return function(t,n){t({type:r.c,alertData:e}),c.a.Add(n().notificationState.notifications)}}function y(e){return{type:r.h,shouldShowSettings:e}}function I(e){return{type:r.i,futureReminders:e}}function N(e,t){return function(n,r,s){s.then(function(n){n.Calendar.snoozeReminders(e,t,o.a.timeZone).catch(function(e){i.h.isCallsBlockedException(e)||a.a.exception("Notifications_SnoozeReminder_Failed",6,e)})})}}function C(e){return function(t,n,i){i.then(function(){l.a.SubscribeAllProviders(e).then(function(){t({type:r.j,isReady:!0})}).catch(function(){})})}}},a47c6d5ccd5afd7e:function(e,t,n){e.exports={notificationText:"_8U-O-2SiNK_Q9zcl92y38",newAppPopupButton:"_3fDUtZvIuuc3WFEkK7ukSE",newAppPopupButtonCell:"_1_FG1wRgBbP0sh2M7RD_i5"}},b042aaeeade8eff1:function(e,t,n){"use strict";n.r(t);var i,a=n("c4daf14da52f3698"),o=n("4ce913af9fa4e292"),r=n("182babe9e251f0d2"),s=n("bed867ddee695404"),c=n("f10d3ac77c67e555"),l=n("731ed2a3f0dad913"),d=n("2abb04ba65f54d21"),u=n("85548b60b933cd24"),f=n("775fde3668a767ba"),p=n("57554efb244a2e6c"),m=n("cce09edcbff44000"),h=n("cf38627dfc9c4c3c"),b=n("d2d530d8ddbc3f76"),S=n("59112cfb0e33e90b"),g=n("2b04678d87561a31"),y=function(e){function t(t){return e.call(this,t)||this}return m.__extends(t,e),t.prototype.getUnseenItemsCount=function(){var e=this,t=0;return null!=this.props.notifications&&this.props.notifications.length>0&&this.props.notifications.forEach(function(n){if((e.props.includeUnseenMailInCount||n.providerType!==S.a.NewMailNotification)&&n.providerType!==S.a.ChatNotification)if(n.providerType===S.a.NewAppNotification&&n.payload){var i=n.payload;t+=i.UnseenCount}else 0!==n.toastState&&1!==n.toastState||t++}),t},t.prototype.componentDidMount=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.render=function(){var e=this.getUnseenItemsCount(),t=Object(c.I)(b.a.UnreadBadge_Title,e.toString(),b.a.Bell_Title);return a.createElement(c.r,{unseenItemCount:e,isParentHovered:this.props.isParentHovered,badgeStyles:Object(c.y)(g.headerButtonBadgePosition)},a.createElement("label",{htmlFor:this.props.bellAriaID,id:this.props.bellAriaLabelID,className:c.P.visuallyHidden},t))},t}(a.Component),I=Object(r.b)(function(e,t){return{notifications:e.notificationState.notifications,includeUnseenMailInCount:!Object(s.isOwa)(e.shellInitDataState.clientData.WorkloadId),isParentHovered:t.isParentHovered}})(y),N=function(e){function t(t){var n=e.call(this,t)||this;return n.setBellAriaLabel=function(e){n.setState({bellAriaLabel:e})},n.state={isHovered:!1,bellAriaLabel:null},n}return m.__extends(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&p.a.perfMarker(p.h.BellTimeToInteractive)},t.prototype.render=function(){var e=this,t={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:null==this.state.bellAriaLabel?b.a.Notification_Title:null,ariaLabelledBy:this.state.bellAriaLabel,affordanceMenuItemText:b.a.Notifications,iconID:"Ringer",iconFontSize:d.headerIconFontSize.toString(),isActive:this.props.isActive,onClick:this.props.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})}};return 0===this.props.renderContext?a.createElement(h.b,m.__assign({},t),a.createElement(I,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:f.NOTIFICATION_BELL_BTN,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel})):a.createElement(h.a,m.__assign({},t))},t}(a.Component),C=Object(r.b)(function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,id:t&&t.id,isActive:e.flexPaneState&&"Notifications"===e.flexPaneState.activeProviderKey}},function(e,t){return{onClick:function(n){n.stopPropagation(),p.a.click(p.d.Notifications,p.b.NotificationsPane,null,null,"Active state: "+t.isActive+", Render context: "+t.renderContext),t.onClick&&t.onClick(n),e(Object(c.N)(n.currentTarget&&n.currentTarget.id)),e(Object(l.e)("Notifications"))}}})(N),v=n("7a5ef637d71d468b"),T=n("d4dd8e7f960da628"),O=n("c8839b99e854a630"),E=n("e0a652b2a7d5d976"),A=n("38b43ea403549748"),_=function(e){function t(t){var n=e.call(this,t)||this;return n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),p.a.click(p.d.Close,p.b.NotificationToast,S.a[n.props.notification.providerType]),n.props.isInFlexPane||n.props.onToastClose(n.props.notification.payload.id),n.props.dismiss(n.props.notification.payload.id)},n.onToastClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.notification.navigationUrl;null!=t&&""!==t&&(p.a.click(p.d.NotificationClick,n.props.isInFlexPane?p.b.NotificationsPane:p.b.NotificationToast,S.a[n.props.notification.providerType],"Mail"),n.props.notification.isCondensed?Object(s.isOwa)(n.props.notificationConfiguration.workloadID)||null!=n.props.notificationConfiguration&&null!=n.props.notificationConfiguration.owaLaunchUrl&&window.open(n.props.notificationConfiguration.owaLaunchUrl,"Mail","toolbar=0,status=0,width=1000,height=325"):Object(T.a)(t)),n.props.isInFlexPane||n.props.onToastClose(n.props.notification.payload.id)},n.handleKeyDown=function(e){13===e.keyCode&&n.onToastClick(e)},n.setEmailState=function(e,t){if(e.stopPropagation(),e.preventDefault(),n.setState({isHover:t}),!n.props.isInFlexPane){var i=n.props.notification.payload.id;t?n.props.clearTimer(i):n.props.setTimer(i)}},n.state={isHover:!1},n}return m.__extends(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t=this,n=this.props.notification.payload,i=null,o="";if(!this.props.isInFlexPane&&this.props.notification.isCondensed){var r=Object(c.I)(b.a.CondensedNewMailMessage,this.props.notification.condensedCount.toString());o=r,i=a.createElement("div",{className:Object(c.y)(A.condensed)},a.createElement(c.h,{className:Object(c.y)(E.icon,A.condensedIcon),fontIconCss:"ms-Icon--Mail"}),a.createElement("span",{className:Object(c.y)(A.condensedMailText,O.e.neutral.dark.font)},r))}else o=n.Sender+" "+n.Subject+" "+n.PreviewText,i=a.createElement("div",{className:Object(c.y)(A.itemContent)},a.createElement("div",{className:Object(c.y)(c.P.table,c.P.maxWidth,c.P.maxHeight)},a.createElement("div",{className:Object(c.y)(A.newMailPersonaImage,c.P.tableCellMiddle)},a.createElement(v.b,{photoSize:32,upn:n.SenderSmtpEmailAddress,displayName:n.Sender,onError:function(){return p.a.tag("NewMailNotification_MePhoto_LoadError",4)}})),a.createElement("div",{className:c.P.tableCellMiddle},a.createElement("span",{className:Object(c.y)(A.mailText,A.sender,E.notificationTitle,O.e.neutral.dark.font)},n.Sender),a.createElement("div",null,a.createElement("div",{className:A.mailIcon},a.createElement(c.h,{className:Object(c.y)(E.icon,O.e.neutral.dark.font),fontIconCss:"ms-Icon--Mail",fontSize:"10px"})),a.createElement("span",{className:Object(c.y)(c.P.maxWidth,A.mailText,A.mailSubject,O.e.neutral.tertiary.font)},n.Subject)))),a.createElement("span",{className:Object(c.y)(A.mailText,A.bodyPreviewText,O.e.neutral.secondary.font)},n.PreviewText));return a.createElement("div",{id:"NewMailItemId","aria-label":o,role:"alert",className:Object(c.y)(A.newMailLink),onContextMenu:function(e){return e.preventDefault},onFocus:function(){t.setState({isHover:!0})},onBlur:function(){t.setState({isHover:!1})},onMouseEnter:function(e){t.setEmailState(e,!0)},onMouseLeave:function(e){t.setEmailState(e,!1)}},a.createElement("button",{type:"button",onFocus:function(){t.setState({isHover:!0})},onBlur:function(){t.setState({isHover:!1})},className:Object(c.y)((e={},e[c.P.visuallyHidden]=!this.state.isHover&&this.props.isInFlexPane,e),E.closeButton,O.e.neutral.secondary.font,O.e.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":b.a.DismissNotification,title:b.a.DismissNotification},a.createElement(c.h,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),a.createElement("a",{role:"link",tabIndex:0,onClick:this.onToastClick,onKeyDown:this.handleKeyDown},a.createElement("div",{className:Object(c.y)(A.newMailPopupButton)},a.createElement("div",{className:Object(c.y)(A.newMailPopupButtonCell)},i))))},t}(a.Component),w=n("840e18fc06f1ddd7"),P=function(e){function t(t){var n=e.call(this,t)||this;return n.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.notification.payload.systemAlert,i=t.ActionUrl;if(p.a.click(p.d.NotificationClick,n.props.isInFlexPane?p.b.NotificationsPane:p.b.NotificationToast,S.a[n.props.notification.providerType],null,n.props.notification.subType),t.ActionCallback&&t.ActionCallback(),null!=i&&""!==i){var a=t.ActionTarget||"_self";window.open(i,a)}n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id)},n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),p.a.click(p.d.Close,p.b.NotificationToast,S.a[n.props.notification.providerType],null,n.props.notification.subType),n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id),n.props.dismiss(n.props.notification.payload.id)},n.handleKeyDown=function(e){13===e.keyCode&&n.onClick(e)},n.setReminderState=function(e,t){e.stopPropagation(),e.preventDefault(),n.setState({isHover:t})},n.state={isHover:!1},n}return m.__extends(t,e),t.prototype.componentDidMount=function(){this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t,n,i=this,o=this.props.notification.payload.systemAlert;return a.createElement("div",{id:"SystemAlert",tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,className:Object(c.y)(w.container,O.e.neutral.light.border),onContextMenu:function(e){return e.preventDefault},onFocus:function(){i.setState({isHover:!0})},onBlur:function(){i.setState({isHover:!1})},onMouseEnter:function(e){return i.setReminderState(e,!0)},onMouseLeave:function(e){return i.setReminderState(e,!1)},"aria-label":o.Title+" "+o.Message,role:"alert"},a.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(c.y)((e={},e[c.P.visuallyHidden]=!this.state.isHover,e),w.systemClose,E.closeButton,O.e.neutral.secondary.font,O.e.neutral.lightAlt.hover.background),"aria-label":b.a.DismissNotification,title:b.a.DismissNotification},a.createElement(c.h,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),a.createElement("div",null,a.createElement(c.h,{className:Object(c.y)(c.P.tableCellMiddle,c.P.floatLeft,O.e.neutral.dark.font,(t={},t[w.alertIcon]=!this.props.isInFlexPane,t),(n={},n[w.alertPaneIcon]=this.props.isInFlexPane,n)),fontIconCss:"ms-Icon--Warning"}),a.createElement("span",{className:Object(c.y)(w.title,O.e.neutral.dark.font)}," ",o.Title),a.createElement("span",{className:Object(c.y)(w.message,E.notificationBodyText,O.e.neutral.secondary.font)},o.Message)),a.createElement("div",{"aria-label":o.ActionText,className:Object(c.y)(E.actionBar,O.e.neutral.accent.font,O.e.neutral.light.border)},a.createElement("a",{tabIndex:0,role:"button",onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":o.ActionText,className:Object(c.y)(E.notificationLink,O.e.neutral.accent.link)},a.createElement("span",{className:E.itemLink},o.ActionText),a.createElement(c.h,{className:Object(c.y)(E.icon,E.actionArrow),fontIconCss:"ms-Icon--Forward"}))))},t}(a.Component),D=n("6d2c591331761015"),R=n("06aaa7d4b6d44083"),x=n("c8fd006355bd5dd7"),k=function(e){function t(t){var n=e.call(this,t)||this;return n.dismiss=function(e){e.preventDefault(),e.stopPropagation(),p.a.click(p.d.Dismiss,n.props.isInFlexPane?p.b.NotificationsPane:p.b.NotificationToast,S.a[S.a.ReminderNotification]),null!=n.props.reminderItem?n.props.onDismiss(n.props.reminderItem.payload.id,n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId):p.a.tag("Notifications_DismissReminder_EmptySelectedReminder",6)},n.setStateWhenBlur=function(){n.state.isIconFocus||null!=n.props.snoozeReminderId||window.setTimeout(function(){n.setState({isReminderFocus:!1}),n.props.onSelectedItem(null)},500)},n.setReminderState=function(e,t){e.preventDefault(),e.stopPropagation(),n.props.snoozeReminderId||n.setState({isHover:t})},n.handleKeyDown=function(e){13===e.keyCode&&n.onClick(e)},n.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.reminderItem.payload.reminder;n.props.snoozeReminderId===t.ReminderItemDataModel.ItemId?n.props.onSnoozeClose():(n.props.onClick(t.ReminderItemDataModel.ItemId),null!=n.props.config&&null!=n.props.config.workloadID&&(t.OpenItem(n.props.config.workloadID,n.props.config.owaLaunchUrl),n.props.onDismiss(n.props.reminderItem.payload.id,n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId)))},n.onSnoozeClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId;n.props.snoozeReminderId?n.props.onSnoozeClose():t&&n.props.onSnoozeClick(t,document.activeElement)},n.state={isHover:!1,isIconFocus:!1,isReminderFocus:!1},n}return m.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.LastUpdatedTime!==e.LastUpdatedTime){var t=this.props.reminderItem.payload.reminder;t.UpdateReferenceTime(this.props.LastUpdatedTime),R.a.isVisibleReminderOverdue(t.ReminderItemDataModel.EndDate)||this.props.removeReminder(this.props.reminderItem.payload.id)}},t.prototype.render=function(){var e,t,n,i,o=this,r=this.props.reminderItem.payload.reminder;r.UpdateReferenceTime(this.props.LastUpdatedTime);var s=this.props.order,l=Object(c.y)(x.remindersRemain,c.P.tableCellMiddle,x.remindersRightColumn,((e={})[O.e.neutral.darkRed.font]=r.IsReminderOverdue,e[O.e.neutral.dark.font]=!r.IsReminderOverdue,e)),d=a.createElement("div",{id:"rmdcontext"+s,"aria-labelledby":"rmdSubject"+s+" rmdBody"+s,className:Object(c.y)(E.overflowHidden,c.P.table,c.P.maxWidth,c.P.maxHeight)},a.createElement("div",{className:Object(c.y)(c.P.tableCellMiddle)},a.createElement(c.h,{className:Object(c.y)(x.reminderIcon,O.e.neutral.dark.font),fontIconCss:"ms-Icon--Event"})),a.createElement("div",{"aria-label":r.ReminderItemDataModel.Subject,className:Object(c.y)(c.P.tableCellMiddle,c.P.maxWidth,E.notificationTitle,O.e.neutral.dark.font)},a.createElement("span",{className:Object(c.y)(x.remindersTitle)},r.ReminderItemDataModel.Subject)),a.createElement("div",{id:"rmdBody"+s,"aria-label":Object(c.I)("{0} {1} {2}",r.TimeToItemStartValue,r.TimeToItemStartUnit,b.a.ReminderOverDue),className:l},a.createElement("div",{className:Object(c.y)((t={},t[c.P.visuallyHidden]=this.state.isHover||this.state.isReminderFocus||this.state.isIconFocus,t))},a.createElement("span",{className:Object(c.y)(x.toastRemindersTimeToStartValue)},r.TimeToItemStartValue),a.createElement("span",{className:Object(c.y)(x.remindersTimeToStartUnit)},r.TimeToItemStartUnit),a.createElement("span",{className:Object(c.y)(O.e.neutral.darkRed.font,(n={},n[c.P.visuallyHidden]=!r.IsReminderOverdue,n))},b.a.ReminderOverDue)),a.createElement("div",{className:Object(c.y)((i={},i[c.P.visuallyHidden]=!this.state.isHover&&!this.state.isReminderFocus&&!this.state.isIconFocus,i))},a.createElement("button",{id:"reminderSnoozeButton"+s,tabIndex:0,title:b.a.ReminderSnooze_Title,onFocus:function(){o.setState({isIconFocus:!0,isReminderFocus:!0})},onBlur:function(){o.setState({isIconFocus:!1})},"aria-label":b.a.ReminderSnooze_Aria_Text,role:"button",className:Object(c.y)(x.alarmButton,E.notificationLink,O.e.neutral.accent.font,O.e.neutral.light.hover.background),onClick:function(e){return o.onSnoozeClick(e)}},a.createElement(c.h,{className:Object(c.y)(E.icon),fontIconCss:"ms-Icon--AlarmClock"})),a.createElement("button",{id:"reminderCloseButton"+s,type:"button",tabIndex:0,onFocus:function(){o.setState({isIconFocus:!0,isReminderFocus:!0})},onBlur:function(){o.setState({isIconFocus:!1,isReminderFocus:!1})},className:Object(c.y)(E.closeButton,x.reminderCloseButton,O.e.neutral.secondary.font,O.e.neutral.light.hover.background),"aria-label":b.a.DismissNotification,role:"button",title:b.a.Dismiss,onClick:function(e){o.dismiss(e)}},a.createElement(c.h,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose"}))))),u=a.createElement("div",{className:Object(c.y)(x.remindersDescription,O.e.neutral.secondary.font)},a.createElement("div",null,r.TimeLabel),""!==r.ReminderItemDataModel.Location&&a.createElement("div",null,r.ReminderItemDataModel.Location)),f=this.props.selectedReminderId===r.ReminderItemDataModel.ItemId;return a.createElement("div",{id:this.props.id,tabIndex:0,className:Object(c.y)(E.toastControl),"aria-labelledby":"rmdRow"+s+" rmdDesc"+s,ref:function(e){f&&e&&e.focus()},role:"region",onContextMenu:function(e){return e.preventDefault()},onClick:this.onClick,onKeyDown:this.handleKeyDown,onFocus:function(){o.setState({isReminderFocus:!0})},onBlur:this.setStateWhenBlur,onMouseEnter:function(e){o.setReminderState(e,!0)},onMouseLeave:function(e){o.setReminderState(e,!1)}},a.createElement("div",{className:Object(c.y)(x.remindersContainer)},a.createElement("div",{id:"rmdRow"+s,"aria-labelledby":"rmdcontext"+s,className:Object(c.y)(x.remindersRow)},d),a.createElement("div",{id:"rmdDesc"+s,"aria-label":r.ReminderItemDataModel.Location,className:Object(c.y)(x.remindersRow)},u)))},t}(a.Component),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m.__extends(t,e),t.prototype.render=function(){var e=Object(c.I)(b.a.DismissAll,this.props.title?this.props.title.toLowerCase():"");return a.createElement("div",{className:Object(c.y)(E.dismissContain)},a.createElement("button",{id:"DismissAll",type:"button",onClick:this.props.onDismissAll,className:Object(c.y)(E.dismissAll,E.itemLink,O.e.neutral.accent.font),"aria-label":e,role:"button",tabIndex:0,title:e},a.createElement("span",null,Object(c.I)(b.a.DismissAll,"").trim())))},t}(a.Component),M="Aggregated_Reminders_Id",F="Flexpane_Reminders_Id",U=n("2a336278accbeab0"),L=function(){function e(){}return e.prototype.getSnoozeOptions=function(){return[-15,-5,0,5,10,15,30,60,120,240,480,720,1440,2880,4320,5760,10080,20160]},e.prototype.getSnoozeDisplayText=function(e){var t="";switch(e){case-15:t=Object(c.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"15");break;case-10:t=Object(c.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"10");break;case-5:t=Object(c.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"5");break;case 0:t=b.a.ReminderSnoozeOption_AtStart_Text;break;case 5:t=Object(c.I)(b.a.ReminderSnoozeOption_Minutes_Text,"5");break;case 10:t=Object(c.I)(b.a.ReminderSnoozeOption_Minutes_Text,"10");break;case 15:t=Object(c.I)(b.a.ReminderSnoozeOption_Minutes_Text,"15");break;case 30:t=Object(c.I)(b.a.ReminderSnoozeOption_Minutes_Text,"30");break;case 60:t=b.a.ReminderSnoozeOption_Hour_Text;break;case 120:t=Object(c.I)(b.a.ReminderSnoozeOption_Hours_Text,"2");break;case 240:t=Object(c.I)(b.a.ReminderSnoozeOption_Hours_Text,"4");break;case 480:t=Object(c.I)(b.a.ReminderSnoozeOption_Hours_Text,"8");break;case 720:t=Object(c.I)(b.a.ReminderSnoozeOption_Day_Text,"0.5");break;case 1440:t=Object(c.I)(b.a.ReminderSnoozeOption_Day_Text,"1");break;case 2880:t=Object(c.I)(b.a.ReminderSnoozeOption_Days_Text,"2");break;case 4320:t=Object(c.I)(b.a.ReminderSnoozeOption_Days_Text,"3");break;case 5760:t=Object(c.I)(b.a.ReminderSnoozeOption_Days_Text,"4");break;case 10080:t=b.a.ReminderSnoozeOption_OneWeek_Text;break;case 20160:t=b.a.ReminderSnoozeOption_TwoWeeks_Text}return t},e}(),B=n("47c425cb724166f8"),z=n("110f05769e8b8b3d"),H=function(e){function t(t){var n=e.call(this,t)||this;return n.onShowOrHideMoreItems=function(e){p.a.click(n.state.ShowMoreRemindersExpanded?p.d.SeeLess:p.d.SeeMore,p.b.NotificationsPane,S.a[S.a.ReminderNotification]),n.setState({ShowMoreRemindersExpanded:!n.state.ShowMoreRemindersExpanded})},n.snoozeOptionChanged=function(e){n.onSnoozeClose();var t=Object(U.b)(n.props.notifications,n.state.SnoozeReminderId,!0);if(t.length>0){var i=parseInt(e),a=void 0;a=i<0?t[0].payload.reminder.ReminderItemDataModel.StartDate.addMinutes(i):0===i?t[0].payload.reminder.ReminderItemDataModel.StartDate:D.c.Now.addMinutes(i);var o=D.c.generateISO8601DateTimeMsStringWithOffset(a);n.props.removeReminder(t[0].payload.id),n.props.snoozeReminders(t.map(function(e){return e.payload.reminder.ReminderItemDataModel.ItemId}),o)}},n.dismissAll=function(){p.a.click(p.d.DismissAll,p.b.NotificationToast,S.a[S.a.ReminderNotification]);var e=n.props.notifications.map(function(e){return e.payload.reminder.ReminderItemDataModel.ItemId});n.props.dismissAll(S.a.ReminderNotification,e)},n.onSelectedItem=function(e){n.setState({SelectedReminderId:e})},n.onSnoozeClose=function(){n.setState(m.__assign({},n.state,{SnoozeReminderId:null}))},n.onSnoozeClick=function(e,t){p.a.click(p.d.Snooze,p.b.NotificationToast,S.a[S.a.ReminderNotification]),n.setState({SnoozeReminderId:e,SnoozeElement:t})},n.onReminderContainerClick=function(e){e.stopPropagation()},n.onReminderItemClick=function(e){p.a.click(p.d.NotificationClick,p.b.NotificationToast,S.a[S.a.ReminderNotification]),n.setState(m.__assign({},n.state,{SelectedReminderId:e}))},n.handleKeydown=function(e){if(e instanceof KeyboardEvent&&"keydown"===e.type&&[38,40,35,36].indexOf(e.which)>-1){var t={index:n.state.CurrentIndex,selectedReminderId:n.state.SelectedReminderId};if(!Object(U.e)(n.props.notifications,e.which,t))return;null!=t.selectedReminderId&&t.index>-1&&n.setState({SelectedReminderId:t.selectedReminderId,CurrentIndex:t.index})}},n.state={SelectedReminderId:null,CurrentIndex:-1,SnoozeReminderId:null,SnoozeElement:null,ShowMoreRemindersExpanded:!1,LastUpdatedTime:D.c.now},n.aggregatedId=n.props.isInFlexPane?F:M,n}return m.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=D.c.Now,n=D.b-1e3*t.second-t.millisecond;setTimeout(function(){e.timeInterval=window.setInterval(function(){return e.setState({LastUpdatedTime:D.c.now})},6e4)},n),Object(c.t)([this.aggregatedId],c.f.KEYDOWN,this.handleKeydown);var i=new L,a=i.getSnoozeOptions();this.dropdownItems=a.map(function(e){return{id:e.toString(),text:i.getSnoozeDisplayText(e)}})},t.prototype.componentWillUnmount=function(){window.clearInterval(this.timeInterval),Object(c.U)([this.aggregatedId],c.f.KEYDOWN,this.handleKeydown)},t.prototype.render=function(){var e,t=this,n=this.props.notifications,i=n.length;this.props.isInFlexPane&&!this.state.ShowMoreRemindersExpanded&&i>3&&(n=n.slice(0,3)),e=this.props.isInFlexPane?Object(c.y)(E.notificationItem,E.itemContent,O.e.neutral.foreground.background,O.e.neutral.lighter.border,O.e.neutral.foregroundAlt.hover.background):Object(c.y)(B.reminderBox,O.e.neutral.lighter.border,O.e.neutral.lighter.hover.background);var o,r,s=0,l=n.map(function(n){var i=n.payload.reminder.ReminderItemDataModel.ItemId===t.state.SelectedReminderId,o=t.aggregatedId+s;return s++,a.createElement("div",{id:"rmdContainer"+s,"aria-labelledby":"rmdcontext"+s,key:o,"aria-selected":i,role:"option",className:e},a.createElement(k,{id:o,order:s,reminderItem:n,isInFlexPane:!1,selectedReminderId:t.state.SelectedReminderId,config:t.props.notificationConfiguration,LastUpdatedTime:t.state.LastUpdatedTime,onClick:t.onReminderItemClick,snoozeReminderId:t.state.SnoozeReminderId,onSnoozeClick:t.onSnoozeClick,onSnoozeClose:t.onSnoozeClose,onSelectedItem:t.onSelectedItem,onDismiss:t.props.dismiss,removeReminder:t.props.dismiss}))});this.props.isInFlexPane?o=i>0&&a.createElement("div",{className:Object(c.y)(E.header,c.P.maxWidth,c.P.maxHeight,O.e.neutral.light.border)},a.createElement("div",{className:Object(c.y)(c.P.tableCellMiddle,E.label)},a.createElement("span",{className:Object(c.y)(E.headerText,O.e.neutral.dark.font),"aria-label":b.a.Reminder_Title},b.a.Reminder_Title)),a.createElement("div",{className:c.P.tableCellMiddle},a.createElement(j,{onDismissAll:this.dismissAll,title:b.a.Reminder_Title})),a.createElement("div",{className:E.clearStyle})):r=a.createElement("div",{id:"ReminderHeader",className:Object(c.y)(c.P.maxWidth,c.P.maxHeight,B.header,O.e.neutral.light.border)},a.createElement("div",{className:Object(c.y)(c.P.tableCellMiddle,B.label)},a.createElement("span",{"aria-label":b.a.Reminder_Title,className:Object(c.y)(E.headerText,O.e.neutral.dark.font)},b.a.Reminder_Title)),a.createElement("div",{className:Object(c.y)(c.P.tableCellMiddle,B.label)},a.createElement(j,{onDismissAll:this.dismissAll,title:b.a.Reminder_Title})));var d=this.props.isInFlexPane?Object(c.y)(E.toastControl,E.headingBar):Object(c.y)(c.P.table,c.P.maxWidth,c.P.maxHeight),u=this.state.SnoozeElement?this.state.SnoozeElement.getBoundingClientRect():null,f=u?{left:u.left-147,top:u.top+32}:{margin:0},p=this.props.isInFlexPane?E.notificationContainer:B.toastScrollRegion;return a.createElement("div",{role:"region",onClick:this.onReminderContainerClick,className:d},o,this.state.SnoozeReminderId&&a.createElement(c.c,{className:z.dropDrown,popupPosition:f,ariaLabel:b.a.ReminderSnooze_Aria_Text,onDismiss:this.onSnoozeClose,isScrollHidden:!0,scrollContainerId:this.props.isInFlexPane?"flexPaneScrollRegion":M},this.dropdownItems.map(function(e){return a.createElement(c.d,m.__assign({className:z.snoozeContextMenuItem,displayText:e.text,key:e.id,itemId:e.id,onclick:function(){return t.snoozeOptionChanged(e.id)},onKeydown:function(){return t.snoozeOptionChanged(e.id)}},e,{role:"button"}))})),r,a.createElement("div",{id:this.aggregatedId,role:"listbox","aria-multiselectable":"true",tabIndex:-1,className:Object(c.y)(p)},l),i>3&&this.props.isInFlexPane&&a.createElement("button",{type:"button",onClick:this.onShowOrHideMoreItems,className:Object(c.y)(E.footer,E.itemLink),"aria-label":this.state.ShowMoreRemindersExpanded?b.a.ShowLess:b.a.ShowMore},a.createElement("span",{className:Object(c.y)(E.showMoreLink,O.e.neutral.accent.font)},this.state.ShowMoreRemindersExpanded?b.a.ShowLess:b.a.ShowMore)))},t}(a.Component),G=n("4860b61820696c48"),W=n("d8e3a7dafcd98817"),K=function(e){function t(t){var n=e.call(this,t)||this;return n.onToastActionClick=function(e){switch(e.preventDefault(),e.stopPropagation(),p.a.click(p.d.NotificationClick,p.b.NotificationToast,S.a[n.props.notification.providerType],null,n.props.notification.subType),i.type){case G.a.message:case G.a.call:try{i.actionLink.action()}catch(e){p.a.exception("ChatNotification_AcceptError",6,e)}break;case G.a.summary:n.props.onRecentsOpen(!0)}n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id)},n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),p.a.click(p.d.Close,p.b.NotificationToast,S.a[n.props.notification.providerType],null,n.props.notification.subType);try{i.cancelLink.action()}catch(e){p.a.exception("ChatNotification_CancelError",6,e)}n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id)},i=n.props.notification.payload,n}return m.__extends(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e=null;switch(i.type){case G.a.message:e=a.createElement("div",{className:Object(c.y)(W.chatContent),onClick:this.onToastActionClick,role:"alert"},a.createElement("div",{className:Object(c.y)(c.P.table,c.P.maxWidth,c.P.maxHeight)},a.createElement("div",{className:Object(c.y)(W.PersonaImage,c.P.tableCellMiddle)},a.createElement(v.b,{photoSize:32,photoUrl:i.image,upn:i.sender,displayName:i.title,onError:function(){return p.a.tag("ChatNotification_MePhoto_LoadError",4)}})),a.createElement("div",{className:c.P.tableCellMiddle},a.createElement("span",{className:Object(c.y)(W.chatTitle,W.chatText,E.notificationTitle,O.e.neutral.dark.font)},i.title),a.createElement("div",null,a.createElement("div",{className:W.chatIcon},a.createElement(c.h,{className:Object(c.y)(E.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),a.createElement("span",{className:Object(c.y)(c.P.maxWidth,W.chatText,W.chatPreview,O.e.neutral.tertiary.font)},i.description)))));break;case G.a.call:e=a.createElement("div",null,a.createElement("div",{className:Object(c.y)(W.chatContent),role:"alert"},a.createElement("div",{className:Object(c.y)(c.P.table,c.P.maxWidth,c.P.maxHeight)},a.createElement("div",{className:Object(c.y)(W.PersonaImage,c.P.tableCellMiddle)},a.createElement(v.b,{photoSize:32,photoUrl:i.image,upn:i.sender,displayName:i.title,onError:function(){return p.a.tag("ChatNotification_MePhoto_LoadError",4)}})),a.createElement("div",{className:c.P.tableCellMiddle},a.createElement("span",{className:Object(c.y)(W.chatTitle,W.chatText,E.notificationTitle,O.e.neutral.dark.font)},i.title),a.createElement("div",null,a.createElement("div",{className:W.chatIcon},a.createElement(c.h,{className:Object(c.y)(E.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),a.createElement("span",{className:Object(c.y)(c.P.maxWidth,W.chatText,W.chatPreview,O.e.neutral.tertiary.font)},i.description))))),a.createElement("div",{className:Object(c.y)(E.actionBar,O.e.neutral.accent.font,O.e.neutral.light.border)},a.createElement("button",{type:"button",onClick:this.onToastActionClick,className:Object(c.y)(O.e.neutral.foreground.background,O.e.neutral.light.border,O.e.neutral.accent.font,O.e.neutral.accent.hover.background,O.e.neutral.foreground.hover.font)},b.a.Accept),a.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(c.y)(O.e.neutral.foreground.background,O.e.neutral.light.border,O.e.neutral.accent.font,O.e.neutral.accent.hover.background,O.e.neutral.foreground.hover.font)},b.a.Ignore)));break;default:e=a.createElement("div",{className:Object(c.y)(W.condensed),onClick:this.onToastActionClick,role:"alert"},a.createElement(c.h,{className:Object(c.y)(E.icon,W.condensedIcon),fontIconCss:"ms-Icon--OfficeChat"}),a.createElement("span",{className:Object(c.y)(W.condensedText,O.e.neutral.dark.font)},i.description))}return a.createElement("div",{onContextMenu:function(e){return e.preventDefault}},a.createElement("button",{type:"button",className:Object(c.y)(E.closeButton,O.e.neutral.secondary.font,O.e.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":b.a.DismissNotification},a.createElement(c.h,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),a.createElement("div",{className:Object(c.y)(W.toastContent)},e))},t}(a.Component),q=n("9bcc53b668a4b1e0"),Z=Object(r.b)(null,function(e){return{onRecentsOpen:function(t){e(Object(q.c)(t))}}})(K),V=n("9ea76cd56c670fee"),Y=n("f8f1208a8eec5749"),J=n("d131e90706759e69"),X=4e3,Q=function(e){function t(t){var n=e.call(this,t)||this;return n.clearTimer=function(e){if(null!=n.state.timers[e]){var t=n.state.timers;t[e]=clearTimeout(t[e])}},n.setTimer=function(e){var t=n.state.timers;t[e]=setTimeout(function(){return n.props.onClose(e)},X),n.setState({timers:t})},n.state={timers:[]},n}return m.__extends(t,e),t.prototype.render=function(){var e,t=this;if(null==this.props.notifications||!this.props.isNotificationsEnabled&&!this.props.chatEnabled)return null;if(document.hidden&&this.props.notifications.filter(function(e){return 0===e.toastType}).length>0)return null;var n=this.props.notifications.filter(function(e){return e.providerType===S.a.ReminderNotification}),i=this.props.notifications.filter(function(e){return e.providerType!==S.a.ReminderNotification}).slice(0,U.f),o=this.props,r={dismiss:this.props.dismiss,onToastClose:this.props.onClose,snoozeReminders:this.props.snoozeReminders,setTimer:this.setTimer,clearTimer:this.clearTimer,notificationConfiguration:o,notificationSetting:this.props.notificationPreferencesData,dismissAll:this.props.dismissAll,removeReminder:this.props.removeReminder};return n.length>0&&o.notificationPreferencesData.EnableReminders&&(e=a.createElement(H,m.__assign({},r,{notifications:n}))),(i.length>0||n.length>0)&&this.props.notifications.length>0&&a.createElement(c.j,{className:Object(c.y)(J.popupControl),onDismiss:function(){},focusTrapSelector:"a[href],button",noFocusOnRender:!0},a.createElement("div",{className:Object(c.y)(J.toastContainer),id:"popupContent"},this.getToast(e,n[0],!1),i.length>0&&i.map(function(n){return V.a.impression(S.a[n.providerType],Y.a.NotificationToast,0,null,null!==n.subType?n.subType:""),e=null,n.providerType===S.a.NewMailNotification&&o.notificationPreferencesData.EnableNewItemNotify?e=a.createElement(_,m.__assign({notification:n},r,{notificationConfiguration:o})):n.providerType===S.a.SystemAlert?e=a.createElement(P,m.__assign({notification:n},r)):t.props.chatEnabled&&n.providerType===S.a.ChatNotification&&(o.notificationPreferencesData.EnableChat||o.notificationPreferencesData.EnableCalling)&&(e=a.createElement(Z,m.__assign({notification:n},r))),null!=e&&t.getToast(e,n,n.subType===G.a.call)})))},t.prototype.getToast=function(e,t,n){if(null==e)return null;var i=Object(U.c)(t,this.props);return a.createElement("div",{key:t.payload.id,"aria-label":b.a.NotificationPopup,"aria-live":"polite",className:Object(c.y)(B.toastSlot,E.notificationToast,O.e.neutral.light.border,O.e.neutral.foreground.background)},e,""!==i&&a.createElement(c.a,{source:i,id:t.payload.id,loop:n,type:"audio/mpeg"}))},t}(a.Component),$=n("a15570f8ebd19e9e"),ee=Object(r.b)(function(e){return{notifications:e.notificationState.notifications.filter(function(e){return 0===e.toastState}),chatEnabled:e.chatState&&e.chatState.chatEnabled,isNotificationsEnabled:null!=e.notificationState&&null!=e.notificationState.notificationsEnabled&&e.notificationState.notificationsEnabled,isSystemNotificationsDisabled:null!=e.notificationState&&null!=e.notificationState.systemNotificationsDisabled&&e.notificationState.systemNotificationsDisabled,owaLaunchUrl:Object(c.J)(e.appsDataState.apps),mailNotificationAudioUrl:e.shellInitDataState.clientData.MailNotificationAudioUrl,systemNotificationAudioUrl:e.shellInitDataState.clientData.SystemNotificationAudioUrl,calendarNotificationAudioUrl:e.shellInitDataState.clientData.CalendarNotificationAudioUrl,callNotificationAudioUrl:e.shellInitDataState.clientData.CallNotificationAudioUrl,chatNotificationAudioUrl:e.shellInitDataState.clientData.ChatNotificationAudioUrl,workloadID:e.shellInitDataState.clientData.WorkloadId,notificationPreferencesData:e.notificationState.notificationPreferencesData}},function(e){return{setToastStatus:function(t,n,i,a){e(Object($.g)(t,n,i,a))},onClose:function(t){e(Object($.g)([t],1))},dismissAll:function(t,n){void 0===n&&(n=[]),e(Object($.d)(t,n))},dismiss:function(t,n){e(Object($.e)(t,n))},removeReminder:function(t){e(Object($.l)(!0,null,t))},snoozeReminders:function(t,n){e(Object($.i)(t,n))}}})(Q),te=n("468f118279816314"),ne=n("178b38bb179b95cd"),ie=n("ac31c6d9df1a7d52"),ae=n("a47c6d5ccd5afd7e"),oe=function(e){function t(t){var n=e.call(this,t)||this;return n.handleKeyDown=function(e){13===e.keyCode&&n.onClick(e)},n.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.notification.payload,i=t.LaunchFullUrl;null==i&&""===i||(window.open(i,"_blank"),p.a.click(p.d.NotificationClick,p.b.NotificationsPane,S.a[n.props.notification.providerType],p.k.getAppTileReferralId(t.ItemID)))},n.setNewAppState=function(e,t){e.stopPropagation(),e.preventDefault(),n.setState({isHover:t})},n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),n.props.dismissAll(e)},n.state={isHover:!1},n}return m.__extends(t,e),t.prototype.render=function(){var e,t=this,n=this.props.notification.payload;return a.createElement("div",{id:"NewAppId",tabIndex:0,onContextMenu:function(e){return e.preventDefault},onFocus:function(){t.setState({isHover:!0})},onBlur:function(){t.setState({isHover:!1})},onMouseEnter:function(e){t.setNewAppState(e,!0)},onMouseLeave:function(e){t.setNewAppState(e,!1)},"aria-label":n.Title+" "+n.Message},a.createElement("button",{id:"newAppCloseButton",type:"button",tabIndex:0,className:Object(c.y)((e={},e[c.P.visuallyHidden]=!this.state.isHover,e),E.closeButton,O.e.neutral.secondary.font,O.e.neutral.lightAlt.hover.background),"aria-label":b.a.DismissNotification,title:b.a.DismissNotification,onClick:this.onCloseButtonClick},a.createElement(c.h,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose"})),a.createElement("div",{id:n.ID,className:Object(c.y)(ae.newAppPopupButton),onClick:this.onClick,role:"alert"},a.createElement("div",{className:Object(c.y)(ae.newAppPopupButtonCell,O.e.neutral.light.border)},a.createElement("div",null,a.createElement("span",{className:Object(c.y)(c.H.segoeSemibold,ae.notificationText,E.notificationTitle,O.e.neutral.dark.font)},n.Title),a.createElement("span",{className:Object(c.y)(c.H.segoeRegular,ae.notificationText,E.notificationBodyText,O.e.neutral.secondary.font)},n.Message)),a.createElement("div",{className:Object(c.y)(E.actionBar,O.e.neutral.accent.font,O.e.neutral.light.border)},a.createElement("a",{tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":n.ActionText,className:Object(c.y)(E.notificationLink,O.e.neutral.accent.link),role:"link"},a.createElement("span",{className:E.itemLink},n.ActionText),a.createElement(c.h,{className:Object(c.y)(E.icon,E.actionArrow),fontIconCss:"ms-Icon--Forward"}))))))},t}(a.Component),re=n("12d3d80075eba4ff"),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(){p.a.click(p.d.DismissAll,p.b.NotificationsPane,S.a[S.a.NewAppNotification]);var e=t.props.notification&&t.props.notification.payload;e&&re.a.dismiss(e.AllNewAppIDs),t.props.dismissAll(S.a.NewAppNotification)},t}return m.__extends(t,e),t.prototype.render=function(){return this.props.notification&&this.props.notification.payload?a.createElement("div",{className:Object(c.y)(E.toastControl,E.headingBar)},a.createElement("div",{className:Object(c.y)(E.header,c.P.maxWidth,O.e.neutral.light.border)},a.createElement("div",{className:Object(c.y)(E.label,c.P.floatLeft)},a.createElement("span",{className:Object(c.y)(E.headerText,O.e.neutral.dark.font),"aria-label":b.a.NotificationMyAppsTitle,tabIndex:0},b.a.NotificationMyAppsTitle)),this.props.notification&&a.createElement(j,{onDismissAll:this.onDismissAll,title:b.a.NewAppTitle}),a.createElement("div",{className:E.clearStyle})),a.createElement("div",{className:Object(c.y)(E.content)},a.createElement("div",{"aria-live":"polite",className:Object(c.y)(E.notificationItem,E.itemContent,O.e.neutral.foreground.background,O.e.neutral.lighter.border,O.e.neutral.foregroundAlt.hover.background)},a.createElement(oe,{dismissAll:this.onDismissAll,notification:this.props.notification})))):null},t}(a.Component),ce=function(e){function t(t){var n=e.call(this,t)||this;return n.setShowMoreMailNotifications=function(){n.state.ShowMoreMailNotifications?p.a.click(p.d.SeeLess,p.b.NotificationsPane,S.a[S.a.NewMailNotification]):p.a.click(p.d.SeeMore,p.b.NotificationsPane,S.a[S.a.NewMailNotification]),n.setState({ShowMoreMailNotifications:!n.state.ShowMoreMailNotifications})},n.onDismissAll=function(e){p.a.click(p.d.DismissAll,p.b.NotificationsPane,S.a[S.a.NewMailNotification]),n.props.dismissAll(S.a.NewMailNotification),n.setState(n.getDefaultState())},n.state=n.getDefaultState(),n}return m.__extends(t,e),t.prototype.getDefaultState=function(){return{ShowMoreMailNotifications:!1,isLessButtonHovered:!1,isMoreButtonHovered:!1}},t.prototype.render=function(){var e=this,t=this.props.notifications.filter(function(e){return e.providerType===S.a.NewMailNotification}).reverse(),n=t.length;return t=!this.state.ShowMoreMailNotifications&&n>3?t.slice(0,3):t,n>0&&a.createElement("div",{className:Object(c.y)(E.toastControl,E.headingBar)},a.createElement("div",{className:Object(c.y)(E.header,c.P.maxWidth,c.P.maxHeight,O.e.neutral.light.border)},a.createElement("div",{className:Object(c.y)(E.label,c.P.floatLeft)},a.createElement("span",{className:Object(c.y)(E.headerText,O.e.neutral.dark.font),"aria-label":b.a.Mail},b.a.Mail)),n>1&&a.createElement(j,{onDismissAll:this.onDismissAll,title:b.a.Mail}),a.createElement("div",{className:E.clearStyle})),a.createElement("div",{className:Object(c.y)(E.content)},t.map(function(t){return a.createElement("div",{key:t.payload.id,"aria-live":"polite",className:Object(c.y)(E.notificationItem,E.itemContent,O.e.neutral.foreground.background,O.e.neutral.lighter.border,O.e.neutral.foregroundAlt.hover.background)},a.createElement(_,{notification:t,dismiss:e.props.dismiss,isInFlexPane:!0,notificationConfiguration:e.props.notificationConfiguration}))}),n>3&&a.createElement("button",{type:"button",onClick:this.setShowMoreMailNotifications,className:Object(c.y)(E.footer,E.itemLink),"aria-label":this.state.ShowMoreMailNotifications?b.a.SeeLessAriaText:b.a.ShowMoreAriaText},a.createElement("span",{className:Object(c.y)(E.showMoreLink,O.e.neutral.accent.font)},this.state.ShowMoreMailNotifications?b.a.ShowLess:b.a.ShowMore))))},t}(a.Component),le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(e){p.a.click(p.d.DismissAll,p.b.NotificationsPane,S.a[S.a.SystemAlert]),t.props.dismissAll&&t.props.dismissAll(S.a.SystemAlert)},t}return m.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.notifications?this.props.notifications.filter(function(e){return e.providerType===S.a.SystemAlert&&(0===e.toastState||1===e.toastState)}):[],n=this.props.notifications?this.props.notifications.filter(function(e){return e.providerType===S.a.SystemAlert&&2===e.toastState}):[],i=n.length+t.length;return t.length>0||n.length>0?a.createElement("div",{className:Object(c.y)(E.content,E.paddingTop)},a.createElement("div",{className:Object(c.y)(E.header,c.P.maxWidth,c.P.maxHeight,O.e.neutral.light.border)},a.createElement("div",{className:Object(c.y)(c.P.tableCellMiddle,E.label)},a.createElement("span",{className:Object(c.y)(E.headerText,O.e.neutral.dark.font),"aria-label":b.a.Alert_Title,tabIndex:0},b.a.Alert_Title)),i>1?a.createElement(j,{onDismissAll:this.onDismissAll,title:b.a.Alert_Title}):null),t.concat(n).map(function(t){return a.createElement("div",{"aria-live":"polite",className:Object(c.y)(E.notificationItem,O.e.neutral.foreground.background,O.e.neutral.lighter.border,O.e.neutral.foregroundAlt.hover.background)},a.createElement(P,{dismiss:e.props.dismiss?e.props.dismiss:null,notification:t,isInFlexPane:!0}))})):null},t}(a.Component),de=n("54be359eb09e7f40"),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusRoot=null,t.showSettingsPane=function(){p.a.click("Notifications_CustomizeSettings",p.b.NotificationsPane,p.c.NotificationSettings),t.props.showSettings(!0)},t.backButtonClicked=function(){t.props.showSettings(!1)},t.dismissAll=function(e){t.props.dismissAll(e),t.focusRoot.focus()},t.handleKeyDown=function(e){13===e.keyCode&&t.showSettingsPane()},t}return m.__extends(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),this.props.setSeenInFlexPane()},t.prototype.render=function(){var e=this,t=null,n=[],i=[],o=[],r=[],s=!0;this.props.notifications.forEach(function(e){if(3!==e.toastState)switch(e.providerType){case S.a.NewMailNotification:o.push(e),s=!1;break;case S.a.ReminderNotification:n.push(e),s=!1;break;case S.a.SystemAlert:i.push(e),s=!1;break;case S.a.NewAppNotification:r.push(e),s=!1}});var d=r.length>0?r[0]:null,u=i.length>0||r.length>0||Object(ie.b)(this.props.chatFeatureEnabled,this.props.notificationPreferencesData);if(this.props.shouldShowSettings)t=a.createElement("div",{id:p.b.NotificationsPane,className:de.settingsContainer},a.createElement(ne.a,{hostId:p.b.NotificationsPane,chatFeatureEnabled:this.props.chatFeatureEnabled,notificationPreferences:this.props.notificationPreferencesData,onToggleNotification:this.props.setNotificationSetting,onToggleAllowNotifications:this.props.toggleAllowNotifications}));else if(u)if(null==this.props||!this.props.isNotificationsEnabled||null==this.props.notifications||0===this.props.notifications.length||s)t=a.createElement("div",{id:p.b.NotificationsPane,className:Object(c.y)(de.section,de.notificationsMessage,de.emptyState,O.e.neutral.dark.font)},a.createElement("div",{id:"EmptyStateImageId",className:de.imgEmptyState}),a.createElement("span",{className:c.H.segoeSemibold,"aria-label":b.a.NoNewNotifications},b.a.NoNewNotifications),a.createElement("span",{"aria-label":b.a.NoNewCheckLaterNote},b.a.NoNewCheckLaterNote));else{var f={dismissAll:this.dismissAll,dismiss:this.props.dismiss,snoozeReminders:this.props.snoozeReminders,notificationConfiguration:this.props,removeReminder:this.props.removeReminder};t=a.createElement("div",{id:p.b.NotificationsPane},i.length>0?a.createElement("div",{tabIndex:-1,className:Object(c.y)(de.section)},a.createElement(le,m.__assign({notifications:i},f))):null,n?a.createElement("div",{tabIndex:-1,className:Object(c.y)(de.section)},a.createElement(H,m.__assign({notifications:n,isInFlexPane:!0},f))):null,this.props.showNewMailNotificationHistory&&o.length>0?a.createElement("div",{tabIndex:-1,className:Object(c.y)(de.section)},a.createElement(ce,m.__assign({notifications:o},f))):null,d?a.createElement("div",{tabIndex:-1,className:Object(c.y)(de.section)},a.createElement(se,m.__assign({notification:d},f))):null)}else t=a.createElement("div",{id:p.b.NotificationsPane,className:Object(c.y)(de.section,de.notificationsDisabled,O.e.neutral.dark.font)},b.a.NotificationsDisabled);return a.createElement("div",{className:de.mainContainer},a.createElement(l.c,{className:Object(c.y)(de.container,O.e.neutral.lighterAlt.background),isActive:this.props.isActive,title:b.a.Notifications,flexPaneProviderID:this.props.flexPaneProviderID,showBackButton:this.props.shouldShowSettings,onBackButtonClicked:this.backButtonClicked},t),!this.props.shouldShowSettings&&a.createElement("div",{className:de.customizeLinkContainer},a.createElement("div",{role:"button",ref:function(t){return e.focusRoot=t},className:Object(c.y)(de.customizeSettingsLink,O.e.neutral.accent.font),"aria-label":b.a.AccountManager,tabIndex:0,onClick:this.showSettingsPane,onKeyDown:this.handleKeyDown},b.a.NotificationSettings)))},t}(l.a),fe=Object(r.b)(function(e,t){return{isActive:t.isActive,shouldShowSettings:e.notificationState.showSettings,notifications:e.notificationState.notifications,setSeenInFlexPane:t.setSeenInFlexPane,showNewMailNotificationHistory:!Object(s.isOwa)(e.shellInitDataState.clientData.WorkloadId),chatFeatureEnabled:e.chatState.chatEnabled,isNotificationsEnabled:e.notificationState.notificationsEnabled,owaLaunchUrl:Object(c.J)(e.appsDataState.apps),workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,upn:e.userState.upn,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,notificationPreferencesData:e.notificationState.notificationPreferencesData}},function(e){return{setSeenInFlexPane:function(){e(Object($.f)())},dismissAll:function(t,n){void 0===n&&(n=[]),e(Object($.d)(t,n))},dismiss:function(t,n){e(Object($.e)(t,n))},showSettings:function(t){e(Object($.h)(t))},onUpdateReminders:function(t){e(Object($.a)(t))},removeReminder:function(t){e(Object($.l)(!0,null,t))},toggleAllowNotifications:function(t,n){e(Object(te.i)(t,n))},setNotificationSetting:function(t,n,i){e(Object(te.h)(t,n,i))},snoozeReminders:function(t,n){e(Object($.i)(t,n))}}})(ue),pe=n("de36ca360c354767"),me=n("0e6a3e4aca161152"),he=n("7bd3263b26b48094"),be=[S.a.NewAppNotification];function Se(e,t,n){var i=e.notificationPreferencesData,a=e.notificationsEnabled,o=e.systemNotificationsDisabled;t&&(a=!!t.NotificationsEnabled&&t.NotificationsEnabled,o=null==t.SystemNotificationsDisabled||t.SystemNotificationsDisabled);var r=e.bellHeaderButtonInLayout;return null!=n&&n.centerCustomizationRegion&&(r=null!=Object(c.E)("NotificationBellIcon",n.centerCustomizationRegion.children)),m.__assign({},e,{notificationsEnabled:a,bellHeaderButtonInLayout:r,systemNotificationsDisabled:o,notificationPreferencesData:i})}function ge(e,t){var n=e.notifications.slice(0);return t.providerType===S.a.NewAppNotification&&(n=n.filter(function(e){return be.indexOf(e.providerType)<0})),n.push(t),m.__assign({},e,{notifications:n})}function ye(e,t,n,i){if(e.providerType===S.a.NewAppNotification){var a=e.payload;null!=a&&(a.UnseenCount=0,e.toastState=t)}e.toastState=t,null!=n&&(e.isCondensed=n),null!=i&&(e.condensedCount=i)}var Ie={notificationState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=Se(c.Q,n.clientData||{},n.layout)}var i=e;switch(t.type){case c.l:return Se(e,t.shellClientData);case c.m:return Se(e,void 0,t.shellLayout);case c.q:return function(e,t){return m.__assign({},e,{notificationPreferencesData:t.notificationPreferenceData})}(e,t);case pe.a:return function(e,t){if(void 0===t.payload)return e;if(void 0!==t.payload.providerType)e=ge(e,t.payload);else if("string"==typeof t.payload&&null!=t.payload){var n=JSON.parse(t.payload);n.providerType===S.a.ReminderNotification&&function(e){var t=e.payload.reminder.ReminderItemDataModel;t.ReminderTime=me.a.parseISO8601DateTime(t.ReminderTime.toString()),t.StartDate=me.a.parseISO8601DateTime(t.StartDate.toString()),t.EndDate=me.a.parseISO8601DateTime(t.EndDate.toString());var n=new he.a(t);e.payload.reminder=n}(n),e=ge(e,n)}return function(e){var t=e.notifications.slice(0),n=t.filter(function(e){return 0===e.toastState&&e.providerType===S.a.NewMailNotification});return n.length>U.f?(t.forEach(function(e){e===n[0]?ye(e,0,!0,n.length):n.slice(1).indexOf(e)>-1&&(e.toastState=1)}),m.__assign({},e,{notifications:t})):e}(e)}(e,t);case pe.k:return function(e,t){var n=e.notifications.slice(0);return t.isRemoved?(n=n.filter(function(e){return e.payload.id!==t.id}),m.__assign({},e,{notifications:n})):null!==t.reminder?(n.forEach(function(e){e.payload.id===t.id&&(e.payload.reminder=t.reminder)}),m.__assign({},e,{notifications:n})):e}(e,t);case pe.g:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];if(t.ids.indexOf(o.payload.id)>-1){ye(o,t.toastStatus,t.isCondensed,t.condensedCount);break}}return m.__assign({},e,{notifications:n})}(e,t);case pe.f:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];0!==o.toastState&&1!==o.toastState||ye(o,2)}return m.__assign({},e,{notifications:n})}(e);case pe.d:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];o.providerType===t.providerType&&ye(o,3)}return m.__assign({},e,{notifications:n})}(e,t);case pe.e:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];t.id===o.payload.id&&ye(o,3)}return m.__assign({},e,{notifications:n})}(e,t);case pe.b:return function(e,t){if(null===t.notifications)return e;var n=e.notifications.slice(0);return t.notifications.forEach(function(e){n.push(e)}),m.__assign({},e,{notifications:n})}(e,t);case pe.c:return function(e,t){var n=e.notifications.slice(0);return n.push({providerType:S.a.SystemAlert,payload:{systemAlert:t.alertData,id:t.alertData.Id},toastType:t.alertData.NotificationToastShouldPersist?1:0,toastState:0,navigationUrl:t.alertData.ActionUrl}),m.__assign({},e,{notifications:n})}(e,t);case pe.h:i=function(e,t){return m.__assign({},e,{showSettings:t.shouldShowSettings})}(e,t);break;case pe.i:i=function(e,t){return m.__assign({},e,{futureReminders:t.futureReminders})}(e,t);break;case pe.j:i=function(e,t){return m.__assign({},e,{isSubscriptionReady:t.isReady})}(e,t)}return i}},Ne=function(){function e(){}return e.prototype.AddSystemNotification=function(e,t,n,i,a,o,r){null==e||null==t||null==n||null==i||null==o||null===r&&null==a||Object(c.L)().dispatch(Object($.c)({Title:e,Message:t,ActionUrl:n,ActionText:i,ActionTarget:a,Id:o,ActionCallback:r,NotificationToastShouldPersist:!0}))},e.prototype.AddNotification=function(e){Object(c.L)().dispatch(Object($.a)(e))},e}();var Ce,ve,Te=n("d619b17cc30e6342"),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m.__extends(t,e),t.prototype.componentDidMount=function(){this.props.isNotificationsEnabled&&(this.props.isSubscriptionReady||this.subscribe(this.props))},t.prototype.componentWillReceiveProps=function(e){this.isNotificationSettingUpdate(this.props,e)&&this.props.isSubscriptionReady&&(Te.a.config.notificationPreferencesData=e.notificationPreferencesData)},t.prototype.componentDidUpdate=function(e){this.props.isNotificationsEnabled!==e.isNotificationsEnabled&&this.props.isNotificationsEnabled&&!this.props.isSubscriptionReady&&this.subscribe(this.props)},t.prototype.render=function(){return null},t.prototype.isNotificationSettingUpdate=function(e,t){if(e.notificationPreferencesData&&t.notificationPreferencesData){var n=e.notificationPreferencesData,i=t.notificationPreferencesData;return n.EnableNewItemNotify!==i.EnableNewItemNotify||n.EnableReminders!==i.EnableReminders}return!1},t.prototype.subscribe=function(e){e.notificationPreferencesData&&e.isNotificationsEnabled&&e.hasEXOLicense&&this.props.subscribe(e)},t}(a.Component),Ee=Object(r.b)(function(e){return{isSubscriptionReady:e.notificationState.isSubscriptionReady,isNotificationsEnabled:e.notificationState.notificationsEnabled&&e.notificationState.bellHeaderButtonInLayout,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,notificationPreferencesData:e.notificationState.notificationPreferencesData,owaLaunchUrl:Object(c.J)(e.appsDataState.apps),isSystemNotificationsDisabled:e.notificationState.systemNotificationsDisabled,doNotFetchSystemAlertsFromPortal:e.shellInitDataState.clientData.DoNotFetchSystemAlertsFromPortal,upn:e.userState.upn,workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl}},function(e){return{updateNotificationPreferences:function(t){e(Object(c.fb)(t))},subscribe:function(t){return e(Object($.j)(t))}}})(Oe),Ae=n("46671b7a418f01a5"),_e=n("cae69437f24306a3"),we=function(e){function t(t){var n=e.call(this,t)||this;return n.setSimpleBellAriaLabel=function(e){n.setState({simpleBellAriaLabel:e})},n.onMouseChange=function(e){return n.setState({isHovered:e})},n.state={isHovered:!1,simpleBellAriaLabel:null},n}return m.__extends(t,e),t.prototype.render=function(){return this.props.isAvailable&&a.createElement("button",{type:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1),onFocus:this.onMouseChange.bind(this,!0),onBlur:this.onMouseChange.bind(this,!1),id:f.NOTIFICATION_BELL_BTN,className:Object(c.y)(g.button,O.e.headerButton,O.e.highContrastButton),role:"button","aria-disabled":"false","aria-label":null==this.state.simpleBellAriaLabel?b.a.Notification_Title:null,"aria-labelledby":this.state.simpleBellAriaLabel},a.createElement(c.h,{fontIconCss:"ms-Icon--Ringer",fontSize:d.headerIconFontSize.toString(),className:Object(c.y)(Ae.icon),isAriaHidden:!0}),a.createElement(I,{isParentHovered:this.state.isHovered,bellAriaID:f.NOTIFICATION_BELL_BTN,bellAriaLabelID:"SimpleBellAriaLabel",setAriaLabelId:this.setSimpleBellAriaLabel}))},t.prototype.componentDidMount=function(){this.props.isAvailable&&(Object(_e.b)(),this.props.registerNotificationsFlexPane())},t.prototype.componentDidUpdate=function(e){e.isAvailable!==this.props.isAvailable&&(Object(_e.b)(),this.props.isAvailable&&this.props.registerNotificationsFlexPane())},t}(a.Component),Pe=Object(r.b)(function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,registerNotificationsFlexPane:t.registerNotificationsFlexPane}})(we);c.cb.register(Ie),Ce=new Ne,ve=d.O365Shell.Notifications,d.O365Shell.Notifications=Ce,ve.applyCalls(Ce);var De=!1,Re=!1,xe=Object(c.L)(),ke=d.O365Shell.RenderSettings&&d.O365Shell.RenderSettings.layout,je={component:fe,key:"Notifications",width:l.b};if(s.CallbackManager.subscribe("ShellDataUpdated",function(){!function(){if(Re)return;var e=document.createElement("div");o.render(a.createElement(r.a,{store:xe},a.createElement(Ee,null)),e),Re=!0}()},!0),ke)ke.centerCustomizationRegion&&Object(c.E)("NotificationBellIcon",ke.centerCustomizationRegion.children)&&(Fe(),f.LazyBellHeaderButton.setComponent(C),s.CallbackManager.invoke("ComponentDimensionChanged","NotificationBellIcon","connected"),je.nativeControlID="NotificationBellIcon",xe.dispatch(Object(l.d)(je)));else{var Me=document.getElementById("O365_MainLink_Bell_Container");if(Me){Fe();o.render(a.createElement(r.a,{store:xe},a.createElement(Pe,{registerNotificationsFlexPane:function(){je.btnId=f.NOTIFICATION_BELL_BTN,xe.dispatch(Object(l.d)(je))}})),Me)}}function Fe(){if(!(De||d.O365Shell.RenderSettings&&d.O365Shell.RenderSettings.disableToasts)){var e=document.getElementById(u.c);if(e){var t=document.createElement("div");t.id="NotificationToastContainer",e.appendChild(t),c.s.isMobileClient()||(o.render(a.createElement(r.a,{store:xe},a.createElement(ee,null)),t),De=!0)}}}s.CallbackManager.subscribe("ShellDataUpdated",function(e,t){Fe()},!0)},bb16b7a2469e91b3:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("9f13d46e2e6ab2a9"),a=n("57554efb244a2e6c"),o=n("93cebf3bb203b06a"),r=n("6d2c591331761015"),s=n("bed867ddee695404"),c=n("f10d3ac77c67e555"),l=n("e8f650bf7e19664b"),d=n("59112cfb0e33e90b"),u=n("a15570f8ebd19e9e"),f=n("5d871a8627d2e882"),p=n("06aaa7d4b6d44083"),m="User",h=o.j.SuiteScope,b=function(){function e(){}return e.LoadItemsFromSessionStorageToState=function(t){var n=[];e.GetNoticationsFromSessionStorage(t).then(function(e){if(null!=e&&e.length>0){var i=e.filter(function(e){return e.providerType!==d.a.ReminderNotification||(p.a.isVisibleReminderOverdue(e.payload.reminder.ReminderItemDataModel.EndDate)&&n.push(e.payload.reminder),!1)});Object(c.L)().dispatch(Object(u.b)(i))}t.notificationPreferencesData.EnableReminders&&(0===n.length&&p.a.GetRemindersFromServer(),p.a.OnGetRemindersSucceeded(n))}).catch(function(){})},e.GetNoticationsFromSessionStorage=function(t){return new Promise(function(n,a){var o=new l.d;o.requestRead(e.notificationsStorageKey),s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then(function(i){if(null!=i&&null!=i.value&&i.hasKey(e.notificationsStorageKey)){var a=i.value(e.notificationsStorageKey);null!==a&&a.length>0&&(Object(s.isOwa)(t.workloadID)||t.notificationPreferencesData.EnableNewItemNotify?n(e.loadNonMailNotificationFromStorage(a)):n(a))}n(null)}).catch(function(e){a(e)})},!0)})},e.Add=function(t){var n=new l.d,i=[];t.forEach(function(e){3!==e.toastState&&i.push(e)}),null!=i&&i.length>0&&(n.requestWrite(i,e.notificationsStorageKey),s.CallbackManager.subscribe("SuiteAPILoaded",function(e){e.Storage.submitStorageRequestToSessionStorage(n).catch(function(){})},!0))},e.RemoveItems=function(t,n){var a=new l.d;a.requestRead(e.notificationsStorageKey),i.b.Instance.Storage.submitStorageRequestToSessionStorage(a).then(function(t){if(null!=t&&null!=t.value&&t.hasKey(e.notificationsStorageKey)){var o=t.value(e.notificationsStorageKey),r=void 0;null!=o&&(r=o.filter(function(e){return e.subType!==n})).length>0&&(a.requestWrite(r,e.notificationsStorageKey),i.b.Instance.Storage.submitStorageRequestToSessionStorage(a).catch(function(){}))}}).catch(function(){})},e.RetrieveSystemAlertsSessionStorage=function(t,n,a){return new Promise(function(o,c){var u=new l.c(h,m,n),f=new l.c(h,m,t),p=new l.d;p.requestRead(u,f),s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.Storage.submitStorageRequestToSessionStorage(p).then(function(t){if(null!=t&&null!=t.value&&t.hasKey(u)){var n=t.value(u);null!=n&&r.c.UTCNow.compare(r.c.parseISO8601DateTime(n))<r.a&&t.hasKey(f)?o(t.value(f)):(e.RemoveItems(d.a.SystemAlert,a),o([]))}else o([])}).catch(function(e){c(e)})},!0)})},e.StoreSystemAlertToCache=function(e,t,n){if(null!=e){var a=new l.c(h,m,n),o=new l.c(h,m,t),c=new l.d;c.requestWrite(r.c.UTCNow.getNativeDateTime(),a),c.requestWrite(e,o),s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.Storage.submitStorageRequestToSessionStorage(c).catch(function(){})},!0)}},e.GetSystemAlertsLastViewedTime=function(){var e=this;return new Promise(function(t,n){var r=new l.d,c=new l.c(h,m,"SystemAlertsLastRefreshDate"),d=null;r.requestRead(c),s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.Storage.submitStorageRequestToSessionStorage(r).then(function(n){if(null!=n&&null!=n.value&&n.hasKey(c)){var i=n.value(c);null!=i&&(d=new Date(i))}else e.GetSystemAlertsLastViewedFromStorage().then(function(e){d=e}).catch(function(){});t(d)}).catch(function(e){o.h.isCallsBlockedException(e)||a.a.exception("Notifications_GetSystemAlertsLastViewedTime_Failed_FromSessionStorage",4,e),n(e)})},!0)})},e.SetSystemAlertsLastViewedToSessionStorage=function(e){var t=new l.d,n=new l.c(h,m,"SystemAlertsLastRefreshDate");t.requestWrite(e,n),i.b.Instance.Storage.submitStorageRequestToSessionStorage(t).catch(function(e){o.h.isCallsBlockedException(e)||a.a.exception("Notifications_SetSystemAlertsLastViewedTime_Failed_ToSessionStorage",4,e)})},e.GetSystemAlertsLastViewedFromStorage=function(){return new Promise(function(e,t){s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.WebShellStorage.readStorage(f.b.User,f.a.SystemMetadata,"SystemAlertsLastRefreshDate").then(function(t){var n;null!=t.value&&(n=new Date(t.value)),e(n)}).catch(function(e){a.a.exception("Notifications_Error_SystemAlerts_ReadFromDocDBGetSystemAlertsLastRefreshTime_Failed",6,e),t(e)})},!0)})},e.SetSystemAlertsLastViewedToStorage=function(){var e=this,t=(new Date).getTime();i.b.Instance.WebShellStorage.writeStorage(f.b.User,f.a.SystemMetadata,"SystemAlertsLastRefreshDate",t).then(function(n){e.SetSystemAlertsLastViewedToSessionStorage(t)}).catch(function(e){a.a.exception("Notifications_Error_SystemAlerts_WriteToDocDBSetSystemAlertsLastRefreshTime_Failed",6,e)})},e.loadNonMailNotificationFromStorage=function(t){return new Promise(function(n,a){var o=new l.d,r=t.filter(function(e){return e.providerType!==d.a.NewMailNotification});o.requestRemove(e.notificationsStorageKey),s.CallbackManager.subscribe("SuiteAPILoaded",function(){i.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then(function(t){o.requestWrite(r,e.notificationsStorageKey),i.b.Instance.Storage.submitStorageRequestToSessionStorage(o).catch(function(){}),n(r)}).catch(function(e){a(e)})},!0)})},e.notificationsStorageKey=new l.c(h,m,"NotificationsHistory"),e}()},c8fd006355bd5dd7:function(e,t,n){e.exports={remindersContainer:"IC086xV1vK4KAwkT82vYH",remindersRow:"_3QYfprS8kuPfoW1VEsTUCx",remindersLeftColumn:"_2maECduqnJBz0k92zNqvaI",remindersTitle:"_2R45rAEGaqe8i5Jfoo0zFp",remindersRemain:"_2hXprRF16xmwvd3u2OOSSx",remindersRightColumn:"FMeJfjtJxM3Z2Bg5RVE8-",toastRemindersTimeToStartValue:"_3qjm1uT79N0Gwfl69NTi95",remindersTimeToStartUnit:"_1nvRHb5BHiDoRzdCmB0ZIz",remindersDescription:"_3btwjlDH_AauJYbeIt3oAs",reminderIcon:"_1Dgbqcfcfbwz53LGQG-B4B",alarmButton:"_1wY4nQZk3MOcpcUD-9R0aE",reminderCloseButton:"_3LhJ5aPVyXmKOvKuBIO07y"}},d131e90706759e69:function(e,t,n){e.exports={popupControl:"_2NhI787EE_RxL3ohWxRO5K",toastContainer:"_1V43WZiAbBa-WU14Lh6mMp",toastContainerHeight:"_26sf4fa_WdNJs2au8_omt_"}},d4dd8e7f960da628:function(e,t,n){"use strict";function i(e){window.open(e,"_blank","width=1000,height=600,top=150,left=150,menubar=no,resizable=yes,status=no,scrollbars=yes,titlebar=no,toolbar=no")}n.d(t,"a",function(){return i})},d619b17cc30e6342:function(e,t,n){"use strict";var i=n("bed867ddee695404"),a=n("f10d3ac77c67e555"),o=n("ac31c6d9df1a7d52"),r=n("9f13d46e2e6ab2a9"),s=n("57554efb244a2e6c"),c=n("59112cfb0e33e90b"),l=n("bb16b7a2469e91b3"),d=n("93cebf3bb203b06a"),u=n("a15570f8ebd19e9e"),f=n("d2d530d8ddbc3f76"),p="PasswordExpiryAlert",m=2,h="PasswordExpiryAlertFetchTime",b=function(){function e(){var e=this;this.retryCount=0,this.OnGetPasswordExpiryAlertSucceeded=function(t){var n=e.CreatePasswordExpirySystemAlert(t);null!=n&&(l.a.StoreSystemAlertToCache(n,p,h),Object(a.L)().dispatch(Object(u.a)(n)))},this.OnGetPasswordExpiryAlertFailedFromOWA=function(t){!1===d.h.isCallsBlockedException(t)&&(s.a.exception("Notifications_GetPasswordExpiryAlertFromOWA",4,t),e.retryCount<m&&(e.retryCount++,e.GetPasswordExpiryAlertFromOWA(e.actionUrl,e.isConsumerShell)))},this.OnGetPasswordExpiryAlertFailedFromWCSS=function(t,n){!1===d.h.isCallsBlockedException(t)&&(s.a.exception("Notifications_GetPasswordExpiryAlertFromWCSS",4,t),e.retryCount<m&&(e.retryCount++,e.GetPasswordExpiryAlertFromWCSS(n)))}}return e.prototype.GetPasswordExpiryAlertFromOWA=function(e,t){var n=this;this.actionUrl=e,this.isConsumerShell=t,r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage(p,h,p).then(function(e){null!==e&&0!==e.length||r.b.Instance.User.getDaysUntilPasswordExpiration().then(n.OnGetPasswordExpiryAlertSucceeded).catch(n.OnGetPasswordExpiryAlertFailedFromOWA)}).catch(function(e){!1===d.h.isCallsBlockedException(e)&&s.a.exception("Notifications_GetPasswordExpiryAlertFromOWA",4,e),r.b.Instance.User.getDaysUntilPasswordExpiration().then(n.OnGetPasswordExpiryAlertSucceeded).catch(n.OnGetPasswordExpiryAlertFailedFromOWA)})},e.prototype.GetPasswordExpiryAlertFromWCSS=function(e){var t=this;this.actionUrl=e,l.a.RetrieveSystemAlertsSessionStorage(p,h,p).then(function(n){null!=n&&0!==n.length||r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch(function(n){return t.OnGetPasswordExpiryAlertFailedFromWCSS(n,e)})}).catch(function(n){r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch(function(n){return t.OnGetPasswordExpiryAlertFailedFromWCSS(n,e)})})},e.prototype.CreatePasswordExpirySystemAlert=function(e){var t=null;if(0<=e&&e<100){var n="";1<e?n=Object(a.I)(f.a.PasswordExpiration_Text,e.toString()):1===e?n=Object(a.I)(f.a.PasswordExpiration_IsOne_Text,e.toString()):0===e&&(n=f.a.PasswordExpirationZero_Text);var i="",o={ActionTarget:"_self",ActionUrl:i=this.isConsumerShell?"https://account.live.com/password/Change":this.actionUrl+"/ChangePassword.aspx",ActionText:f.a.ChangePassword_Link,Title:f.a.ChangePassword_Title,Id:p,Message:n};t={providerType:c.a.SystemAlert,subType:p,payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:i}}return t},e}(),S=n("2a336278accbeab0"),g=function(){function e(){}return e.handle=function(e,t,n,i){if(null!==e){var o=e;if("Reload"!==o.EventType){var r=Object(a.L)(),s=(null===o.SenderSmtpEmailAddress?"":o.SenderSmtpEmailAddress.trim().toLowerCase())!==(null!=i?i.trim().toLowerCase():""),l=t.UserOptions.IsFocusedInboxEnabled||"Other"!==o.InferenceClassification;if(s&&l){var d={providerType:c.a.NewMailNotification,payload:o,toastType:0,toastState:0,navigationUrl:Object(a.I)("{0}?path=/owa&ispopout=1&ItemID={1}",n,encodeURIComponent(o.ItemId))},f=Object(S.d)();d.payload.id=c.a[c.a.NewMailNotification]+f,r.dispatch(Object(u.a)(d))}}}},e}(),y=n("6d2c591331761015"),I=function(){function e(){this.OnGetSystemAlertsSucceeded=function(e){l.a.SetSystemAlertsLastViewedToStorage()},this.OnGetSystemAlertsFailed=function(e){e&&!d.h.isCallsBlockedException(e)&&(e.message=s.k.replaceUPNs(e.message),s.a.exception("Notifications_Error_GetSystemAlertsFromAdmin",4,e))}}return e.prototype.GetSystemAlerts=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.GetSystemAlertsLastViewedTime().then(function(t){var n=new Date;(null==t||n.getTime()-t.getTime()>y.a)&&r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch(e.OnGetSystemAlertsFailed)}).catch(function(t){d.h.isCallsBlockedException(t)||(t.message=s.k.replaceUPNs(t.message),s.a.exception("Notifications_Error_ReadingStorage",6,t)),r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch(e.OnGetSystemAlertsFailed)})},e}(),N=function(){function e(){}return e.CreateAlert=function(){var e=null,t=Object(a.L)().getState(),n=Object(a.J)(t.appsDataState.apps);if("AdminPortal"!==t.shellInitDataState.clientData.WorkloadId){var i={Title:f.a.TimeZoneAlertTitle,Message:f.a.TimeZoneAlertText,ActionText:f.a.TimeZoneAlertActionText,ActionTarget:"_self",Id:"TimeZoneAlert",ActionUrl:n||""};e={providerType:c.a.SystemAlert,subType:"TimeZoneAlert",payload:{systemAlert:i,id:i.Id},toastType:1,toastState:0,navigationUrl:i.ActionUrl},Object(a.L)().dispatch(Object(u.a)(e))}},e}(),C="OofAlert",v="OofAlertFetchTime",T=2,O=function(){function e(e){var t=this;this.launchFullUrl=e,this.retryCount=0,this.OnGetOofAlertSucceeded=function(e){var n=t.CreateOofSystemAlertArray(e);null!=n&&(l.a.StoreSystemAlertToCache(n,C,v),Object(a.L)().dispatch(Object(u.a)(n)))},this.OnGetOofAlertFailed=function(e){!1===d.h.isCallsBlockedException(e)&&(e.message=s.k.replaceUPNs(e.message),s.a.exception("Notifications_Error_GettingOOFAlerts",6,e),t.retryCount<T&&(t.retryCount++,t.GetOofAlert()))}}return e.prototype.GetOofAlert=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage(C,v,C).then(function(t){null!=t&&0!==t.length||r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)}).catch(function(t){!1===d.h.isCallsBlockedException(t)&&s.a.exception("Notifications_Error_ReadingOOFAlertFromStorage",4,t),r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)})},e.prototype.CreateOofSystemAlertArray=function(e){var t=null;if(null!=e&&e.IsOofOn){var n=this.launchFullUrl.indexOf("/mail/"),i=this.launchFullUrl.indexOf("/owa/"),a="";if(-1!==n)a=this.launchFullUrl.substring(0,n)+"?#path=/options/automaticreplies";else{if(-1===i)return null;a=this.launchFullUrl.substring(0,i)+"?#path=/options/automaticreplies"}var o={Title:f.a.AutomaticReplies_Title,Message:f.a.AutomaticRepliesOn_Text,ActionText:f.a.AutomaticRepliesOff_Text,ActionTarget:"_self",Id:C,ActionUrl:a};t={providerType:c.a.SystemAlert,subType:C,payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:a}}return t},e}(),E=n("06aaa7d4b6d44083"),A=n("12d3d80075eba4ff");n.d(t,"a",function(){return _});var _=function(){function e(){}return e.SubscribeAllProviders=function(t){e.config=t;var n=e.config;return n.isSystemNotificationsDisabled||e.subscribeSystemNotification(),n.isConsumerShell||(A.a.myAppsUrl=n.myAppsUrl,A.a.getNewAppNotification()),new Promise(function(t,i){r.b.Instance.User.getOwaUserConfiguration().then(function(i){if(null!=i){e.owaUserConfiguration=i;var r=Object(o.f)(i,n.notificationPreferencesData);if(n.notificationPreferencesData=r,e.subscribeNewMailNotification(),e.subscribeReminderNotification(),l.a.LoadItemsFromSessionStorageToState(n),r)Object(a.L)().dispatch(Object(a.fb)(r));t(!0)}}).catch(function(e){e&&e.message&&e.message.indexOf("OwaInvalidUserLanguageException")>-1?(N.CreateAlert(),t(!0)):(s.a.exception("Notifications_GetOwaUserConfiguration_Failed",6,e),i(e))})})},e.subscribeNewMailNotification=function(){var t=e.config,n={subscriptionId:c.a[c.a.NewMailNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:c.a[c.a.NewMailNotification]}};r.b.Instance.Notification.subscribe(n,function(n){t.isNotificationsEnabled&&t.notificationPreferencesData.EnableNewItemNotify&&null!==n&&g.handle(n,e.owaUserConfiguration,t.owaLaunchUrl,t.upn)})},e.subscribeReminderNotification=function(){var t=e.config,n={subscriptionId:c.a[c.a.ReminderNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:c.a[c.a.ReminderNotification]}};r.b.Instance.Notification.subscribe(n,function(n){t.isNotificationsEnabled&&t.notificationPreferencesData.EnableReminders&&null!==n&&E.a.handleNotification(n,e.owaUserConfiguration)})},e.subscribeSystemNotification=function(){var t=e.config;t.isConsumerShell||t.isOnPremShell||t.doNotFetchSystemAlertsFromPortal||(new I).GetSystemAlerts();r.b.Instance.Calendar.IsInitialized&&Object(i.isOwa)(t.workloadID)&&new O(t.owaLaunchUrl).GetOofAlert();var n=new b;t.isConsumerShell||t.isOnPremShell?n.GetPasswordExpiryAlertFromOWA(t.portalUrl,t.isConsumerShell):n.GetPasswordExpiryAlertFromWCSS(t.portalUrl)},e.owaUserConfiguration=null,e}()},d8e3a7dafcd98817:function(e,t,n){e.exports={condensed:"_2coRSXVG86mHAM7nwWQgGP",condensedIcon:"iwWU5Lx_WOtcYEdSm_AnO",condensedText:"_39OuR33j93MvQiXEOXkUIn",toastContent:"blMeeV7G4vB61P-tNmzp3",chatContent:"_2FJD8zxFQsE8_7YTFlzZZt",PersonaImage:"_3Taf5f7ONoQ5_HeV-wqbyx",chatText:"_3bqzeSZPQicLIKjlN2RyVH",chatTitle:"_1COk0efwPoLTd6QyxPAyVW",chatIcon:"_1TWeNrZTQo1orXJq-Ond1F",chatPreview:"JvR4SAQCn280H46GABOVt"}},de36ca360c354767:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"k",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"f",function(){return r}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"j",function(){return p});var i="suiteux-notification.ADD_NOTIFICATION",a="suiteux-notification.UPDATE_NOTIFICATION",o="suiteux-notification.SET_TOAST_STATUS",r="suiteux-notifications.SET_SEEN_IN_FLEXPANE",s="suiteux-notifications.DISMISS_ALL_NOTIFICATIONS_FOR_PROVIDER",c="suiteux-notifications.DISMISS_NOTIFICATION_FOR_PROVIDER",l="suiteux-notification.ADD_NOTIFICATIONS_FROM_SESSIONSTORAGE",d="suiteux-notification.ADD_SYSTEM_NOTIFICATION",u="suiteux-notification.SHOW_SETTINGS_ACTION",f="suiteux-notification.UPDATE_FUTUREREMINDERS_ACTION",p="suiteux-notification.UPDATE_IS_SUBSCRIPTION_READY_ACTION"},e0a652b2a7d5d976:function(e,t,n){e.exports={flexPaneSidePadding:"_2uzwtR_RPHq-MC57ex0H2j",itemTitle:"_3-ZrBHzyB6h_whhFTrdwxZ",backButton:"_15FmBrhDNg13ctimbf142",backIcon:"_1GP58_9SgeEMyAlzzQYttg",notificationItem:"_3KX97eUCTqEt0ebfD7M_nd",notificationToast:"_3omchOxIycsiT4VrS-YiFH",notificationContainer:"_1o0PbPelk6aApLsz9D_jch",notificationButton:"M_p41xLAaQq10NCIGb0jY",notificationBodyText:"_1d0PGcHSjsXRncCNVUXGuT",notificationLink:"_18MsfyhUKFDxu6KCs3cNLG",icon:"_3CxyRi3gBzBIS8iNEJb4Ol",closeButton:"_2ZVK5ec6A6Yffrn-JgdtoS",dismissAll:"_5wsTAPYxOSuFzZwXbDu6h",dismissContain:"_3N748kGx6v9Vs1zTANwqEi",notificationTitle:"_3Cv6cZCYJXWb9AkFsd4-mW",hidden:"_3iP9JagBTMcINTwBbwmvG8",actionBar:"_3KU6VOYpqJcGtlW9VG4uwQ",actionArrow:"_3Q1pNi8HhB9HqvnkaaXWtT",paddingRight:"F3zA6Ubt5Et0NM-JGl2Zj",displayBlock:"sO53YARa4treHFlDeJHqU",clearStyle:"_3E3SWd2Cws1OUc924UeAZ3",headerText:"_3UX3H6c15_DZCeBFM8bPGy",overflowHidden:"_1gwCXdwURnA5Ybn2rpIY28",itemLink:"_28JJsBGlVB_3Ixqms0ZUSW",headingBar:"_2jvMKWXfUsFccZ8ptVd0hC",toastControl:"_3PzDn8uoV0zs_T7nuRjCgs",header:"_1kIAPpqE3vKXAKRmY5L7UA",label:"_18tDpgGiL-kyZhFmCPSGeZ",content:"_2Nr7E0AQq07Gpq1NUOr-B0",itemContent:"_2Fq6MuPq43zzlMi7e20ByI",showMoreLink:"Qjkh5UvnZbiNHef6MJpqa",footer:"_1CUgnKMLchqQUqi7POnodr",paddingTop:"_244299pY5bUUJn-PWFzZYU"}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_notifications_end"),shellPerformance.measure("shell_notifications","shell_notifications_start","shell_notifications_end"));